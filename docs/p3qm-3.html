<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr Rosaria Lena">
<meta name="dcterms.date" content="2025-01-06">
<meta name="description" content="Lectures 6-8 - use Bransden-Joachain Ch.3 and Griffiths Ch.2 for reference">

<title>P3 Quantum Mechanics - 3&nbsp; The Schrödinger equation and some QM formalism</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./p3qm-4.html" rel="next">
<link href="./p3qm-2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p3qm-3.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Schrödinger equation and some QM formalism</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Schrödinger equation and some QM formalism</span></h1>
                  <div>
        <div class="description">
          <em>Lectures 6-8</em> - use <em>Bransden-Joachain</em> Ch.3 and <em>Griffiths</em> Ch.2 for reference
        </div>
      </div>
                </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">email</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Dr Rosaria Lena </p>
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              rosaria.lena@glasgow.ac.uk
            </p>
        </div>
      </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 6, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">P3 Quantum Mechanics</a> 
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./P3-Quantum-Mechanics.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./P3-Quantum-Mechanics.epub">
              <i class="bi bi-bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3qm-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Origins of QM</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3qm-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Wavefunctions and the uncertainty principle</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3qm-3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Schrödinger equation and some QM formalism</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3qm-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Solutions of Schrödinger Equations in 1D - Bound states</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3qm-5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Solutions of Schrödinger Equations in 1D - Scattering states</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3qm-6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Angular momentum theory</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3qm-ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Summary of exercises</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3qm-faqs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">FAQs</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link active" data-scroll-target="#learning-objectives"><strong>Learning objectives</strong></a></li>
  <li><a href="#the-importance-of-the-superposition-principle" id="toc-the-importance-of-the-superposition-principle" class="nav-link" data-scroll-target="#the-importance-of-the-superposition-principle"><span class="header-section-number">3.1</span> The importance of the superposition principle</a></li>
  <li><a href="#the-time-dependent-schrödinger-equation" id="toc-the-time-dependent-schrödinger-equation" class="nav-link" data-scroll-target="#the-time-dependent-schrödinger-equation"><span class="header-section-number">3.2</span> The time-dependent Schrödinger equation</a>
  <ul class="collapse">
  <li><a href="#sec-op-SE" id="toc-sec-op-SE" class="nav-link" data-scroll-target="#sec-op-SE"><span class="header-section-number">3.2.1</span> Operators in the Schrödinger equation</a></li>
  <li><a href="#exercise" id="toc-exercise" class="nav-link" data-scroll-target="#exercise"><span class="header-section-number">3.2.2</span> <span style="color:#336699;">Exercise</span></a></li>
  <li><a href="#continuity-condition" id="toc-continuity-condition" class="nav-link" data-scroll-target="#continuity-condition"><span class="header-section-number">3.2.3</span> Continuity condition</a></li>
  <li><a href="#the-time-dependent-schrödinger-equation-in-3d" id="toc-the-time-dependent-schrödinger-equation-in-3d" class="nav-link" data-scroll-target="#the-time-dependent-schrödinger-equation-in-3d"><span class="header-section-number">3.2.4</span> The time-dependent Schrödinger equation in 3D</a></li>
  </ul></li>
  <li><a href="#probability-conservation" id="toc-probability-conservation" class="nav-link" data-scroll-target="#probability-conservation"><span class="header-section-number">3.3</span> Probability conservation</a></li>
  <li><a href="#the-time-independent-schrödinger-equation" id="toc-the-time-independent-schrödinger-equation" class="nav-link" data-scroll-target="#the-time-independent-schrödinger-equation"><span class="header-section-number">3.4</span> The time-independent Schrödinger equation</a></li>
  <li><a href="#operators-expectation-values-and-eigenfunctions" id="toc-operators-expectation-values-and-eigenfunctions" class="nav-link" data-scroll-target="#operators-expectation-values-and-eigenfunctions"><span class="header-section-number">3.5</span> Operators, expectation values and eigenfunctions</a>
  <ul class="collapse">
  <li><a href="#operators" id="toc-operators" class="nav-link" data-scroll-target="#operators"><span class="header-section-number">3.5.1</span> Operators</a></li>
  <li><a href="#expectation-values" id="toc-expectation-values" class="nav-link" data-scroll-target="#expectation-values"><span class="header-section-number">3.5.2</span> Expectation values</a></li>
  <li><a href="#eigenfunctions" id="toc-eigenfunctions" class="nav-link" data-scroll-target="#eigenfunctions"><span class="header-section-number">3.5.3</span> Eigenfunctions</a></li>
  </ul></li>
  <li><a href="#sec-general-sol-TDSE" id="toc-sec-general-sol-TDSE" class="nav-link" data-scroll-target="#sec-general-sol-TDSE"><span class="header-section-number">3.6</span> General solution of the TDSE - expansion in energy eigenfunctions</a></li>
  <li><a href="#commutators" id="toc-commutators" class="nav-link" data-scroll-target="#commutators"><span class="header-section-number">3.7</span> Commutators</a>
  <ul class="collapse">
  <li><a href="#properties-of-commutators" id="toc-properties-of-commutators" class="nav-link" data-scroll-target="#properties-of-commutators"><span class="header-section-number">3.7.1</span> Properties of commutators</a></li>
  <li><a href="#the-canonical-commutation-relation" id="toc-the-canonical-commutation-relation" class="nav-link" data-scroll-target="#the-canonical-commutation-relation"><span class="header-section-number">3.7.2</span> The canonical commutation relation</a></li>
  <li><a href="#the-generalised-uncertainty-principle" id="toc-the-generalised-uncertainty-principle" class="nav-link" data-scroll-target="#the-generalised-uncertainty-principle"><span class="header-section-number">3.7.3</span> The generalised uncertainty principle</a></li>
  <li><a href="#exercise-3" id="toc-exercise-3" class="nav-link" data-scroll-target="#exercise-3"><span class="header-section-number">3.7.4</span> <span style="color:#336699;">Exercise</span></a></li>
  </ul></li>
  <li><a href="#time-evolution-of-expectation-values" id="toc-time-evolution-of-expectation-values" class="nav-link" data-scroll-target="#time-evolution-of-expectation-values"><span class="header-section-number">3.8</span> Time evolution of expectation values</a>
  <ul class="collapse">
  <li><a href="#the-ehrenfest-theorem-and-the-correspondence-principle" id="toc-the-ehrenfest-theorem-and-the-correspondence-principle" class="nav-link" data-scroll-target="#the-ehrenfest-theorem-and-the-correspondence-principle"><span class="header-section-number">3.8.1</span> The Ehrenfest theorem and the correspondence principle</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">3.9</span> Summary</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="learning-objectives" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="learning-objectives"><strong>Learning objectives</strong></h2>
<ol type="1">
<li><p>Understand the role of the time-dependent and time-independent Schrödinger equations and their applications</p></li>
<li><p>Familiarise yourself with the concepts of operators in quantum mechanics, their mathematical structure and physical meaning</p></li>
<li><p>Understand the conservation of probability and its implications for the wavefunction</p></li>
<li><p>Evaluating expectation values and their time evolution</p></li>
<li><p>Understand the meaning of expectation values and the connection between quantum physics and the classical limit</p></li>
</ol>
<p><em>The material of this lecture is mostly covered in Chapter 3 of Bransden-Joachain and <span class="citation" data-cites="bransden1989introduction">(<a href="#ref-bransden1989introduction" role="doc-biblioref">Bransden and Joachain 1989</a>)</span> and Chapter 2 of Griffiths <span class="citation" data-cites="griffiths2019introduction">(<a href="#ref-griffiths2019introduction" role="doc-biblioref">Griffiths and Schroeter 2019</a>)</span>.</em></p>
<hr>
</section>
<section id="the-importance-of-the-superposition-principle" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="the-importance-of-the-superposition-principle"><span class="header-section-number">3.1</span> The importance of the superposition principle</h2>
<p>Before getting into this chapter, we need a premise to clarify why I’ll go back and talk about single plane waves after all we discussed in the previous chapter. In short: <strong>why will we keep using single plane waves in the following?</strong></p>
<p>In the previous chapter we saw that we could in principle describe a free particle using a single plane wave (<a href="p3qm-2.html#eq-plane-wave">Equation&nbsp;<span>2.6</span></a>), but this leads to complication, such as infinite delocalisation in space. We saw that to get around this (and other) issues, we can consider a sum (or <em>linear combination</em>) of wavefunctions with different weights, and we saw that in the continuum, for infinitely many waves, this leads to a Fourier transform of a wavefunction in momentum space (<a href="p3qm-2.html#eq-wavepacket-cont">Equation&nbsp;<span>2.15</span></a>).</p>
<p>There is one important principle that we need to keep in mind.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>If two wavefunctions <span class="math inline">\(\Psi_1\)</span> and <span class="math inline">\(\Psi_2\)</span> are both solutions of a wave equation which is <strong>linear</strong> and <strong>homogeneous</strong>, the <strong>superposition principle</strong> ensures that any linear combination <span class="math inline">\(c_1 \Psi_1 + c_2 \Psi_2\)</span> (with constants <span class="math inline">\(c_1\)</span> and <span class="math inline">\(c_2\)</span>), is also a solution of the same wave equation.</p>
<p>This can be extended to as many waves as we want! So in general it is enough to find the solution to a wave equation as a plane wave than as a wavepacket.</p>
</div>
</div>
</section>
<section id="the-time-dependent-schrödinger-equation" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="the-time-dependent-schrödinger-equation"><span class="header-section-number">3.2</span> The time-dependent Schrödinger equation</h2>
<p>The energy of a free particle is given by its kinetic energy. For a particle of mass <span class="math inline">\(m\)</span>, moving in one direction <span class="math inline">\(x\)</span> with momentum <span class="math inline">\(p_x\)</span>, we can write</p>
<p><span id="eq-energy-free-particle"><span class="math display">\[
E = \frac{p_x^2}{2m}.
\tag{3.1}\]</span></span></p>
<p>Let’s consider a plane wave to describe it… <span id="eq-plane-wave-xt"><span class="math display">\[
\Psi(x,t)=Ae^{i(kx-\omega t)}=Ae^{i(p_x x-Et)/\hbar},
\tag{3.2}\]</span></span> where we used the relations <span class="math inline">\(k=p_x/\hbar\)</span> and <span class="math inline">\(\omega=E/\hbar\)</span>.</p>
<p>If we consider the wavefunction at the time <span class="math inline">\(t=0\)</span>, <span class="math inline">\(\Psi(x,0)=Ae^{ikx}=Ae^{ip_x/\hbar}\)</span> we can see from <a href="#eq-plane-wave-xt">Equation&nbsp;<span>3.2</span></a> that the time evolution of a wavefunction <span class="math inline">\(\Psi(x)\)</span> of definite energy can be obtained from <span id="eq-plane-wave-evolution"><span class="math display">\[
\Psi(x,t)=e^{-iEt/\hbar}\Psi(x,0),
\tag{3.3}\]</span></span></p>
<p>so during the time evolution of a quantum state having a defined energy <em>only the phase is evolving</em>, and the state <span class="math inline">\(\Psi(x,t)\)</span> is called a <strong>stationary state</strong>, satisfying the condition</p>
<p><span id="eq-prob-t-prob-0"><span class="math display">\[
|\Psi(x,t)|^2=|\Psi(x,0)|^2.
\tag{3.4}\]</span></span></p>
<p>If we differentiate <a href="#eq-plane-wave-xt">Equation&nbsp;<span>3.2</span></a> with respect to time, we obtain</p>
<p><span id="eq-plane-wave-dt"><span class="math display">\[
\frac{\partial \Psi(x,t)}{\partial t}=-\frac{iE}{\hbar}\Psi(x,t),
\tag{3.5}\]</span></span></p>
<p>and if we differentiate twice with respect to <span class="math inline">\(x\)</span>, we find</p>
<p><span id="eq-plane-wave-d2x"><span class="math display">\[
\frac{\partial^2 \Psi(x,t)}{\partial x^2}=-\frac{p_x^2}{\hbar^2}\Psi(x,t).
\tag{3.6}\]</span></span></p>
<p>Using <a href="#eq-energy-free-particle">Equation&nbsp;<span>3.1</span></a>, we see that <a href="#eq-plane-wave-xt">Equation&nbsp;<span>3.2</span></a> satisfies the partial differential wave equation</p>
<p><span id="eq-schrodinger-eq-no-potential"><span class="math display">\[
i\hbar \frac{\partial}{\partial t}  \Psi(x,t) = -\frac{\hbar^2}{2m}\frac{\partial^2}{\partial x^2} \Psi(x,t).
\tag{3.7}\]</span></span></p>
<p>This is the <strong>one-dimensional time-dependent Schrödinger equation for a free particle</strong>.</p>
<p>Now, this wave equation is <em>linear</em> and <em>homogeneous</em>, so a linear superposition of plane waves, such as the wavepacket of <a href="p3qm-2.html#eq-wavepacket-cont">Equation&nbsp;<span>2.15</span></a>, will still be a solution of <a href="#eq-schrodinger-eq-no-potential">Equation&nbsp;<span>3.7</span></a>.</p>
<p>We can generalise the Schrödinger equation of <a href="#eq-schrodinger-eq-no-potential">Equation&nbsp;<span>3.7</span></a> to the case where a particle is not free, but it is subject to a time-independent potential <span class="math inline">\(U(x)\)</span>, hence it is acted on by a force <span class="math inline">\(F=-\frac{d U}{d x}\)</span>.</p>
<p>In this case, we get the following form of the <em>one-dimensional time-dependent Schrödinger equation for a particle moving in a potential</em>.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
One-dimensional time-dependent Schrödinger equation
</div>
</div>
<div class="callout-body-container callout-body">
<p><span id="eq-schrodinger-eq-time-dep"><span class="math display">\[
i\hbar \frac{\partial}{\partial t}  \Psi(x,t) = -\frac{\hbar^2}{2m}\frac{\partial^2}{\partial x^2} \Psi(x,t)+U(x)\Psi(x,t),
\tag{3.8}\]</span></span></p>
<p>where <span class="math inline">\(U(x)\)</span> is a time-independent potential.</p>
</div>
</div>
<p>Whilst we are considering a time-independent potential here, we can have an even more general form of the Schrödinger equation with a time-dependent potential <span class="math inline">\(U(x,t)\)</span>. In this course however we will mostly focus on the case of time-independent potentials.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that the time-dependent Schrödinger equation (TDSE)(<a href="#eq-schrodinger-eq-time-dep">Equation&nbsp;<span>3.8</span></a>) contains a <em>first order time derivative</em> <span class="math inline">\(\partial/\partial t\)</span>, which means that if the initial value of the wavefunction is given at an initial time <span class="math inline">\(t=t_0\)</span>, i.e.&nbsp;<span class="math inline">\(\Psi(x,t_0)\)</span>, then the value of the wavefunction at any later time <span class="math inline">\(t\)</span> can be found by solving the TDSE.</p>
<p>Therefore the fundamental task is to obtain a solution to <span class="math inline">\(\Psi(x,t)\)</span> to the Schrödinger equation (<a href="#eq-schrodinger-eq-time-dep">Equation&nbsp;<span>3.8</span></a>) that satisfies the given initial conditions.</p>
</div>
</div>
<section id="sec-op-SE" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="sec-op-SE"><span class="header-section-number">3.2.1</span> Operators in the Schrödinger equation</h3>
<p>Let’s start to introduce some words that we will use during the whole course and that we will describe more in detail later in the chapter.</p>
<p>The first thing it is useful to introduce here is the concept of <strong>operator</strong>, which are mathematical entities that transform one wavefunction into another.</p>
<p>The term on the left hand side of <a href="#eq-schrodinger-eq-no-potential">Equation&nbsp;<span>3.7</span></a>, <span class="math inline">\(i\hbar \frac{\partial}{\partial t}\)</span>, applied on the wavefunction, is the <em>total energy operator</em> - a mathematical function (of time, <span class="math inline">\(t\)</span>) acting on the wavefunction that returns the total energy, and we indicate with the symbol <span class="math inline">\(\hat{E}\)</span>. To indicate operators we use the hat symbol.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Total energy operator
</div>
</div>
<div class="callout-body-container callout-body">
<p><span id="eq-total-en-op"><span class="math display">\[
\hat{E} = i\hbar \frac{\partial}{\partial t}
\tag{3.9}\]</span></span></p>
</div>
</div>
<p>This operator yields the same result of another operator that also gives the total energy of the system, but acts on the spatial coordinates instead of time. This is the the <em>Hamiltonian operator</em>, <span class="math inline">\(\hat{H}\)</span>, which describes the sum of the potential and kinetic energy operators, respectively <span class="math inline">\(\hat{T}=\frac{-\hbar^2}{2m}\frac{\partial^2}{\partial x^2}\)</span> and <span class="math inline">\(\hat{U}\)</span>.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hamiltonian operator
</div>
</div>
<div class="callout-body-container callout-body">
<p><span id="eq-hamiltonian-op"><span class="math display">\[
\hat{H} = -\frac{\hbar^2}{2m}\frac{\partial^2}{\partial x^2}+U(x,t).
\tag{3.10}\]</span></span></p>
</div>
</div>
<p>For the right hand side of <a href="#eq-schrodinger-eq-no-potential">Equation&nbsp;<span>3.7</span></a> we can also define the <em>momentum operator</em> <span class="math inline">\(\hat{p}\)</span> (in 1D) as below.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Momentum operator (1D)
</div>
</div>
<div class="callout-body-container callout-body">
<p><span id="eq-momentum-op"><span class="math display">\[
\hat{p}_x=-i\hbar\frac{\partial}{\partial x}.
\tag{3.11}\]</span></span></p>
</div>
</div>
<p>We will talk more about operators later in the chapter.</p>
<p>Having introduced this formalism, we can cast the TDSE of <a href="#eq-schrodinger-eq-time-dep">Equation&nbsp;<span>3.8</span></a> in the following alternative forms:</p>
<p><span id="eq-TDSE-H"><span class="math display">\[
i\hbar \frac{\partial}{\partial t}\Psi(x,t) = \hat{H}\Psi(x,t),
\tag{3.12}\]</span></span></p>
<p><span id="eq-TDSE-EH"><span class="math display">\[
\hat{E}\Psi(x,t) = \hat{H}\Psi(x,t).
\tag{3.13}\]</span></span></p>
</section>
<section id="exercise" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="exercise"><span class="header-section-number">3.2.2</span> <span style="color:#336699;">Exercise</span></h3>
<p>Test the time-dependent Schrödinger equation with a plane wave of amplitude <span class="math inline">\(A\)</span> and a flat potential <span class="math inline">\(U(x)=U\)</span>. What is the energy obtained?</p>
<details>
<summary>
Solution
</summary>
<p><span class="math inline">\(\Psi(x,0)=Ae^{i(kx-\omega t)}\)</span>.</p>
<p>– Add rest of solution –</p>
</details>
</section>
<section id="continuity-condition" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="continuity-condition"><span class="header-section-number">3.2.3</span> Continuity condition</h3>
<p>The following is important and clarifies why in the previous chapter we imposed certain conditions on the wavefunctions.</p>
<p>If the potential <span class="math inline">\(U(x)\)</span> is a continuous function of <span class="math inline">\(x\)</span>, then every function in <a href="#eq-schrodinger-eq-time-dep">Equation&nbsp;<span>3.8</span></a>, i.e.&nbsp;<span class="math inline">\(\Psi(x,t), \partial\Psi/\partial t, \partial \Psi/\partial x\)</span>, must be continuous.</p>
<p>If <span class="math inline">\(U(x)\)</span> shows any finite discontinuities (jumps) with <span class="math inline">\(x\)</span>, then <span class="math inline">\(\partial^2\Psi(x)/\partial x^2\)</span> should also have corresponding finite jumps. For this to happen, we need $ /x$ to be continuous with <span class="math inline">\(x\)</span>: if this were not the case, <span class="math inline">\(\partial^2\Psi(x)/\partial x^2\)</span> would be infinite at points in which $ /x$ changed discontinuously. The continuity of $ /x$ on the other end also implies that <span class="math inline">\(\Psi(x,t)\)</span> and <span class="math inline">\(\partial\Psi/\partial t\)</span> have to be continuous.</p>
<p><em>What about the continuity with time?</em></p>
<p>If <span class="math inline">\(U(x,t)\)</span> is a continuous function of <span class="math inline">\(t\)</span>, so will be <span class="math inline">\(\Psi(x,t)\)</span> and <span class="math inline">\(\partial\Psi/\partial t\)</span>. However, if <span class="math inline">\(U(x,t)\)</span> has a finite jump with time, <span class="math inline">\(\partial\Psi/\partial t\)</span>, while <span class="math inline">\(\Psi(x,t)\)</span> will still be a continuous function of <span class="math inline">\(t\)</span>.</p>
</section>
<section id="the-time-dependent-schrödinger-equation-in-3d" class="level3" data-number="3.2.4">
<h3 data-number="3.2.4" class="anchored" data-anchor-id="the-time-dependent-schrödinger-equation-in-3d"><span class="header-section-number">3.2.4</span> The time-dependent Schrödinger equation in 3D</h3>
<p>We can generalise the 1D TDSE to 3D as follows:</p>
<p><span id="eq-TDSE-3D"><span class="math display">\[
i\hbar \frac{\partial}{\partial t}  \Psi(\mathbf{r},t) = -\frac{\hbar^2}{2m}\nabla^2 \Psi(\mathbf{r},t)+U(\mathbf{r})\Psi(\mathbf{r},t),
\tag{3.14}\]</span></span> where <span id="eq-laplacian"><span class="math display">\[
\nabla^2 = \frac{\partial^2}{\partial x^2}+\frac{\partial^2}{\partial y^2}+\frac{\partial^2}{\partial z^2}
\tag{3.15}\]</span></span></p>
<p>is the Laplacian operator.</p>
<p>It is useful now to refresh the definitions of gradient and divergence as well, as they will be used in the following section. The gradient <span class="math inline">\(\nabla\)</span> is defined as <span id="eq-gradient"><span class="math display">\[
\nabla=\frac{\partial}{\partial x}+\frac{\partial}{\partial y}+\frac{\partial}{\partial z},
\tag{3.16}\]</span></span></p>
<p>and we can build the divergence from the gradient, by associating an unit vector to each partial derivative, for each direction. Remember that gradient and Laplacian act on functions, whereas the divergence is a vector, so can be used for scalar or vector product with another vector.</p>
</section>
</section>
<section id="probability-conservation" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="probability-conservation"><span class="header-section-number">3.3</span> Probability conservation</h2>
<p>In the previous chapter we explained how, according to the Born’s postulate, the wavefunction has the role of probability amplitude and it can be used to define the probability density (see <a href="p3qm-2.html#eq-prob-density-wavefunction-1D">Equation&nbsp;<span>2.2</span></a>).</p>
<p>We have also seen that this leads to the normalization condition for the wavefunction (<a href="p3qm-2.html#eq-normalization-wavefunc">Equation&nbsp;<span>2.4</span></a>), since the probability to find the particle over all space must be equal to one.</p>
<p>Let’s now consider what happens to the probability as time changes. Since there is no loss of information, we expect this to be unchanged, so the wavefunction <span class="math inline">\(\Psi(x,t)\)</span> should be normalised at all times: <span class="math inline">\(\int |\Psi(x,t)|^2dx=1\)</span>. This means that <strong>the probability is conserved</strong> over the whole volume, and mathematically we can write this condition, that we will demonstrate in the following, as <span class="math display">\[
\frac{d}{dt}\int_V P(\mathbf{r},t) d\mathbf{r} = 0.
\]</span></p>
<p>Using the definition of probability density (<a href="p3qm-2.html#eq-prob-density-wavefunction-1D">Equation&nbsp;<span>2.2</span></a>), we can write the left hand term above as <span class="math display">\[
\frac{d}{dt}\int_V P(\mathbf{r},t) d\mathbf{r} = \int_V d\mathbf{r} \frac{d}{dt}(\Psi^*(\mathbf{r},t)\Psi(\mathbf{r},t))=\int_V d\mathbf{r} \left[\Psi^* \left(\frac{d\Psi}{dt}\right)+\left(\frac{d\Psi^*}{dt}\Psi\right) \right],
\]</span></p>
<p>where we could take the derivative <span class="math inline">\(d/dt\)</span> inside the integral because the probability function is continuous with continuous partial derivatives.</p>
<p>Applying the TDSE (<a href="#eq-schrodinger-eq-time-dep">Equation&nbsp;<span>3.8</span></a>) we can cast this in the form</p>
<p><span id="eq-prob-cons-1"><span class="math display">\[
\frac{d}{dt}\int_V d\mathbf{r} P(\mathbf{r},t) = \int_V d\mathbf{r} \frac{i\hbar}{2m}\left[\Psi^* \frac{d^2}{d\mathbf{r}^2}\Psi-\left(\frac{d^2}{d\mathbf{r}^2}\Psi^*\right) \Psi \right].
\tag{3.17}\]</span></span></p>
<p>Using the definitions of gradient and divergence (<a href="#eq-gradient">Equation&nbsp;<span>3.16</span></a>), we can rewrite <a href="#eq-prob-cons-1">Equation&nbsp;<span>3.17</span></a> in the form</p>
<p><span id="eq-prob-cons-2"><span class="math display">\[
\frac{d}{dt}\int_V d\mathbf{r} P(\mathbf{r},t) = \int_V \mathbf{\nabla}\cdot \frac{i\hbar}{2m}\left[\Psi^* \nabla\Psi-\left(\nabla\Psi^*\right) \Psi \right].
\tag{3.18}\]</span></span></p>
<p>For convenience we can introduce the <em>vector field</em> <span id="eq-probability-current"><span class="math display">\[
\mathbf{j}(\mathbf{r},t)= -\frac{i\hbar}{2m}\left[\Psi^* \nabla\Psi-\left(\nabla\Psi^*\right) \Psi \right],
\tag{3.19}\]</span></span></p>
<p>which is known as <strong>probability current</strong> or <strong>probability flux</strong>, and <a href="#eq-prob-cons-2">Equation&nbsp;<span>3.18</span></a> can be written as</p>
<p><span id="eq-prob-cons-3"><span class="math display">\[
\frac{d}{dt}\int_V d\mathbf{r} P(\mathbf{r},t) = -\int_V \nabla\cdot \mathbf{j}(\mathbf{r},t) d\mathbf{r} = -\int_S \mathbf{j}\cdot d\mathbf{S} = 0,
\tag{3.20}\]</span></span></p>
<p>where in the last passage we used the divergence theorem (aka Green’s theorem), stating that the integral of the divergence of a vector, over a volume <span class="math inline">\(V\)</span>, is equal to the surface integral of the component of that vector along the outward normal, taken over a closed surface <span class="math inline">\(S\)</span>.</p>
<p>Now, the last integral over the surface <span class="math inline">\(S\)</span> in the last integral of <a href="#eq-prob-cons-3">Equation&nbsp;<span>3.20</span></a> extends to infinity, and since the wavefunction is not fully delocalised (because it can be normalised), then its extension to infinity will be zero and the integral is overall equal to zero (<span class="math inline">\(\Psi\to 0\)</span> if <span class="math inline">\(\mathbf{r}\to \infty\)</span>).</p>
<p>Notably, from this result in <a href="#eq-prob-cons-3">Equation&nbsp;<span>3.20</span></a> we can say that the probability current respects a <strong>conservation law</strong>, which has the form of a continuity equation, as below.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Conservation equation for the probability
</div>
</div>
<div class="callout-body-container callout-body">
<p><span id="eq-probability-conservation"><span class="math display">\[
\frac{\partial}{\partial t} P(\mathbf{r},t) = -\mathbf{\nabla}\cdot \mathbf{j}(\mathbf{r},t).
\tag{3.21}\]</span></span></p>
<p>Physically this means that any change in probability density at a point is balanced by a flow of probability current into or out of that (differential) region.</p>
</div>
</div>
<p>What do we learn from this? That physical wavefunctions must have finite probability fluxes: we cannot have infinite rates of probability density moving between spatial regions (or more generally between regions in any generalised coordinates of the system).</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important - Implications for wavefunctions
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>The term <span class="math inline">\(\nabla\Psi(\mathbf{r})\)</span> in <span class="math inline">\(J(\mathbf{r})\)</span> means that the spatial wavefunction must be <em>continuous</em>, to avoid delta-function spikes in flux;</li>
<li><span class="math inline">\(\nabla\cdot \mathbf{j}\)</span> in the probability conservation (<a href="#eq-prob-cons-3">Equation&nbsp;<span>3.20</span></a>) means that the wavefunction must be <em>differentiable</em> everywhere, <span class="math inline">\(\frac{\partial\Psi}{\partial x}\)</span> must be continuous, otherwise there would be an unphysical divergence of <span class="math inline">\(\frac{\partial P}{\partial t}\)</span> (cfr <a href="#eq-probability-conservation">Equation&nbsp;<span>3.21</span></a>).</li>
<li>Square-integrability coming from the normalization condition means that <span class="math inline">\(\Psi(x)\to 0\)</span> for <span class="math inline">\(|x|\to \infty\)</span>.</li>
</ol>
<p>There is a caveat: for infinite potentials and infinitely fast changes, the second of these rules no longer holds.</p>
</div>
</div>
<!-- As $J(\mathbf{r})$ contains both $\Psi(\mathbf{r})$ and $\nabla\Psi(\mathbf{r})$ terms, both the wavefunction and its derivative must be continuous functions, i.e. $\Psi$ must be continuous and differentiable, or smooth. -->
<p>So <span class="math inline">\(\Psi\)</span> must be continuous and differentiable (have continuous derivatives), or smooth. These requirements, that we anticipated in the previous chapter, in addition to the established normalization requirement of square-integrability, are the key to deriving the boundary conditions that allow us to find wavefunctions for various quantum systems, seen in the following chapters.</p>
<p>Another important result is that the probability current (<a href="#eq-probability-current">Equation&nbsp;<span>3.19</span></a>) is identically zero if either:</p>
<ol type="1">
<li>the wavefunction <span class="math inline">\(\Psi(\mathbf{r}, t)\)</span> is real-valued; or</li>
<li>it has a complex phase which applies uniformly to all space positions <span class="math inline">\(x\)</span>, hence unaffected by the space derivative <span class="math inline">\(\nabla\)</span>.</li>
</ol>
<p>The first of these is trivial to see: if <span class="math inline">\(\Psi\)</span> is real valued then <span class="math inline">\(\Psi^* = \Psi\)</span> and <span class="math inline">\((\nabla\Psi^*) = \nabla\Psi\)</span>, so the two terms in <span class="math inline">\(\mathbf{j}\)</span> (cf. <a href="#eq-probability-current">Equation&nbsp;<span>3.19</span></a>) cancel.</p>
<p>The second is slightly less obvious: if <span class="math inline">\(\Psi = e^{i\Phi}\psi(\mathbf{r})\)</span>, then <span class="math inline">\(\Psi^*\nabla\Psi = e^{i\Phi}e^{-i\Phi}\psi\nabla\psi=\psi\nabla\psi=\Psi\nabla\Psi^*\)</span>, and again the two terms cancel.</p>
<p>The consequence of this second case in particular is that <em>stationary states, whose time-evolution is a uniform, energy-coupled phase <span class="math inline">\(e^{iEt/\hbar}\)</span>, have no probability flux</em>. Which is a good thing: they are stationary states precisely because their probability distribution is time-invariant, so there’d better not be any probability current flowing between regions!</p>
</section>
<section id="the-time-independent-schrödinger-equation" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="the-time-independent-schrödinger-equation"><span class="header-section-number">3.4</span> The time-independent Schrödinger equation</h2>
<p>Let’s go back to considering the TDSE in 1D, <a href="#eq-schrodinger-eq-time-dep">Equation&nbsp;<span>3.8</span></a>.</p>
<p>If the potential <span class="math inline">\(U(x)\)</span> is time-independent, we can use the method of separation of variables for the wavefunction:</p>
<p><span class="math display">\[
\Psi(x,t)=\psi(x)T(t).
\]</span></p>
<p>Then <span class="math display">\[
\frac{\partial \Psi}{\partial t} = \psi(x)\frac{dT}{dt},\quad \frac{\partial^2 \Psi}{\partial x^2} = \frac{d^2\psi}{dx^2}T(t),
\]</span></p>
<p>and we can rewrite the TDSE, <a href="#eq-schrodinger-eq-time-dep">Equation&nbsp;<span>3.8</span></a>, as <span class="math display">\[
i\hbar \psi(x)\frac{dT}{dt}=-\frac{\hbar^2}{2m}\frac{d^2\psi(x)}{dx^2}T(t)+V(x)\psi(x)T(t).
\]</span></p>
<p>Dividing this by <span class="math inline">\(\Psi=\psi T\)</span>, we obtain</p>
<p><span id="eq-TISE-der-1"><span class="math display">\[
i\hbar \frac{1}{T(t)}\frac{dT}{t}=-\frac{\hbar^2}{2m}\frac{1}{\psi(x)}\frac{d^2\psi(x)}{dx^2}+V(x),
\tag{3.22}\]</span></span></p>
<p>where it is clear that all the time dependence is on the left hand side and all the space dependence on the right hand side, so this is of the form: function of t = function of x, for all t and all x. This means that both sides must be equal to a constant! We call this constant <span class="math inline">\(E\)</span>, as it represents the total energy - we can see this by comparing the operators on each side to the total energy operator and the Hamiltonian operator defined in <a href="#eq-total-en-op">Equation&nbsp;<span>3.9</span></a> and <a href="#eq-hamiltonian-op">Equation&nbsp;<span>3.10</span></a>.</p>
<p>From the RHS of <a href="#eq-TISE-der-1">Equation&nbsp;<span>3.22</span></a>, we obtain the (1D) <strong>time-independent Schrödinger equation</strong>.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Time-independent Schrödinger equation
</div>
</div>
<div class="callout-body-container callout-body">
<p><span id="eq-TISE"><span class="math display">\[
\left[-\frac{\hbar^2}{2m}\frac{d^2}{dx^2}+V(x)\right]\psi(x) = E \psi(x),
\tag{3.23}\]</span></span> which can also be written as <span id="eq-TISE-H"><span class="math display">\[
\hat{H}\psi(x)=E\psi(x)
\tag{3.24}\]</span></span> using the definition of the Hamiltonian operator <span class="math inline">\(\hat{H}\)</span> (<a href="#eq-hamiltonian-op">Equation&nbsp;<span>3.10</span></a>).</p>
</div>
</div>
<p>In the following section we will see that this is an <em>eigenvalue equation</em>.</p>
<p>From the LHS of <a href="#eq-TISE-der-1">Equation&nbsp;<span>3.22</span></a>, we can extract</p>
<p><span id="eq-SE-time-dep-only"><span class="math display">\[
i\hbar \frac{1}{T(t)}\frac{dT}{t}=E\implies i\hbar \frac{dT}{t}=ET(t),
\tag{3.25}\]</span></span></p>
<p>which is easy to solve: <span id="eq-time-op"><span class="math display">\[
T(t)=C e^{-iEt/\hbar},
\tag{3.26}\]</span></span></p>
<p>where <span class="math inline">\(C\)</span> is an arbitrary constant and we can set it to <span class="math inline">\(C=1\)</span>.</p>
<p>We can then write the general solution of a wavefunction with separable variables (again, this holds for <span class="math inline">\(U\)</span> independent of <span class="math inline">\(t\)</span>), as a stationary state.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stationary states
</div>
</div>
<div class="callout-body-container callout-body">
<p>A stationary state is a state with a <em>defined total energy</em>, <span class="math inline">\(E\)</span>, and has the following form: <span id="eq-stationary-state"><span class="math display">\[
\Psi(x,t)=\psi(x)e^{-iEt/\hbar}.
\tag{3.27}\]</span></span></p>
<p>The state (i.e.&nbsp;the wavefunction) itself is evolving with time, but the time evolution is just a phase, hence <em>the probability density is time-independent</em>: <span id="eq-stationary-state-prob"><span class="math display">\[
|\Psi(x,t)|^2=\Psi^*(x,t)\Psi(x,t)=\psi^*(x)e^{iEt/\hbar}\psi(x)e^{-iEt/\hbar}=|\Psi(x,0)|^2
\tag{3.28}\]</span></span></p>
</div>
</div>
<p>In fact, we have already anticipated this at the beginning of the chapter when we looked at a plane wave, <a href="#eq-plane-wave-evolution">Equation&nbsp;<span>3.3</span></a>.</p>
</section>
<section id="operators-expectation-values-and-eigenfunctions" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="operators-expectation-values-and-eigenfunctions"><span class="header-section-number">3.5</span> Operators, expectation values and eigenfunctions</h2>
<p>In this section we will introduce some notation and concepts that will be <em>fundamental</em> for the whole course (and for other courses next year).</p>
<section id="operators" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="operators"><span class="header-section-number">3.5.1</span> Operators</h3>
<p>In <a href="#sec-op-SE"><span>Section&nbsp;3.2.1</span></a> we have already anticipated what operators are.</p>
<p><em>Operators are mathematical entities that transform a wavefunction onto another wavefunction</em>.</p>
<p>In fact, we have already defined the <em>Hamiltonian operator</em> (<a href="#eq-hamiltonian-op">Equation&nbsp;<span>3.10</span></a>), which gives the total energy of the system, and the <em>momentum operator</em> (<a href="#eq-momentum-op">Equation&nbsp;<span>3.11</span></a>). Both of these quantities are physical <em>observables</em>, i.e.&nbsp;physical quantities that we can measure. In general, observable such as momentum, position, spin, angular momentum, etc, are described by operators. However, the opposite is not true! <em>Not all operators are observable</em>, and we will see an example of this when we do the quantum harmonic oscillator.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hermitian operators
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Observables are represented by <em>Hermitian</em> operators.</strong></p>
<p>Hermitian operators are operators that return <em>real</em> eigenvalues, therefore the following is valid:</p>
<p><span id="eq-hermitian-op"><span class="math display">\[
\int \psi^* \hat{A} \psi dx = \int (\hat{A}^* \psi^*)\psi dx.
\tag{3.29}\]</span></span></p>
</div>
</div>
<p>Physical quantities like momentum or energy can be “pulled out” of wavefunctions by applying the operators on them.</p>
<p>In the following you can see some examples of this, with the momentum and total energy operators (<a href="#eq-momentum-op">Equation&nbsp;<span>3.11</span></a> and <a href="#eq-total-en-op">Equation&nbsp;<span>3.9</span></a>), applied on a plane wave <span class="math inline">\(\Psi(x,t)=Ae^{ikx-\omega t}\)</span>.</p>
<p><span id="eq-p-eigenvalue"><span class="math display">\[
\hat{p}\Psi = -i\hbar\frac{\partial \Psi}{\partial x} = -i\hbar\frac{\partial A e^{i(kx-\omega t)}}{\partial x} = \hbar k Ae^{i(kx-\omega t)}=p\Psi,
\tag{3.30}\]</span></span></p>
<p><span id="eq-E-eigenvalue"><span class="math display">\[
\hat{E}\Psi = i\hbar\frac{\partial \Psi}{\partial t} = i\hbar\frac{\partial A e^{i(kx-\omega t)}}{\partial t} = \hbar\omega\Psi = E\Psi.
\tag{3.31}\]</span></span></p>
<section id="more-operators" class="level4" data-number="3.5.1.1">
<h4 data-number="3.5.1.1" class="anchored" data-anchor-id="more-operators"><span class="header-section-number">3.5.1.1</span> More operators</h4>
<p>The <strong>canonical operators</strong>, in position-space representation, are:</p>
<ul>
<li><strong>Total energy:</strong> <span class="math inline">\(\hat{E} = i\hbar \frac{\partial}{\partial t}\)</span></li>
<li><strong>Position:</strong> <span class="math inline">\(\hat{x}\)</span> (1D) or <span class="math inline">\(\hat{\mathbf{r}}\)</span> (3D)</li>
<li><strong>Momentum:</strong> <span class="math inline">\(\hat{p}_x=-i\hbar\frac{\partial}{\partial x}\)</span> (1D) or <span class="math inline">\(\hat{\mathbf{p}}=-i\hbar\nabla\)</span></li>
</ul>
<p>From these, all other operators can be constructed, including:</p>
<ul>
<li><strong>Kinetic energy:</strong> <span class="math inline">\(\hat{T}=-\frac{\hbar^2}{2m}\nabla^2\)</span></li>
<li><strong>Hamiltonian</strong>: <span class="math inline">\(\hat{H} = -\frac{\hbar^2}{2m}\frac{\partial^2}{\partial x^2}+U(x,t)\)</span></li>
<li><strong>Angular momentum:</strong> <span class="math inline">\(\hat{L} = \hat{\mathbf{r}}\times\hat{\mathbf{p}}=-i\hbar \mathbf{r}\times\mathbf{\nabla}\)</span>.</li>
</ul>
<p>We will encounter many more operators during the course.</p>
</section>
</section>
<section id="expectation-values" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="expectation-values"><span class="header-section-number">3.5.2</span> Expectation values</h3>
<p>In Chapter 2 we have discussed the Born’s interpretation of the wavefunction, which is related to the probability density (<a href="p3qm-2.html#eq-prob-density-wavefunction-1D">Equation&nbsp;<span>2.2</span></a>).</p>
<p>For each run of an experiment in quantum mechanics we can’t predict exactly the outcome in a deterministic way, due to the probabilistic nature of QM, but if we run the experiment many times, we can have an <em>average of many measurement</em>, which is what we would expect to obtain in the classical limit: this is called the <strong>expectation value</strong>, and it is defined as follows</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Expectation values
</div>
</div>
<div class="callout-body-container callout-body">
<p>The expectation value of an operator <span class="math inline">\(\hat{A}\)</span> (described by a function <span class="math inline">\(f(x)\)</span>), calculated on the wavefunction <span class="math inline">\(\Psi(x)\)</span>, is <span id="eq-expectation-value"><span class="math display">\[
\langle \hat{A} \rangle = \int_{-\infty}^{\infty} dx \Psi^*(x)\hat{A}(x)\Psi(x)
\tag{3.32}\]</span></span></p>
</div>
</div>
<p>Just make a “sandwich” of the operator between the wavefunction and its complex conjugate, as in <a href="#fig-sandwich">Figure&nbsp;<span>3.1</span></a>!</p>
<div id="fig-sandwich" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/sandwich.png" class="img-fluid figure-img" style="width:40.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.1: A way to think about the expectation value and remember it!</figcaption>
</figure>
</div>
<p>For some “normal” operators <span class="math inline">\(A(x)\)</span> (such as <span class="math inline">\(\hat{x}\)</span>), <span class="math inline">\(A\)</span> and <span class="math inline">\(\Psi\)</span> commute, i.e.&nbsp;their order is not relevant: <span class="math inline">\(A(x)\Psi(x)=\Psi(x)A(x)\)</span>. In such cases: <span class="math inline">\(\langle \hat{A} \rangle = \int_{-\infty}^{\infty} dx \Psi^*(x)A(x)\Psi(x) = \int_{-\infty}^{\infty} dx A(x)P(x).\)</span></p>
<p>However, this is not always the case! For example, the momentum operator <span class="math inline">\(p_x\)</span> is defined by a derivative over <span class="math inline">\(x\)</span>, so it will change the function that follows it, and the order in this case matters!</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>The ordering in <span class="math inline">\(\langle \hat{A}\rangle =\int_{-\infty}^{\infty} dx \Psi^*(x) \hat{A}(x) \Psi(x)\)</span> matters!</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Variance of an operator
</div>
</div>
<div class="callout-body-container callout-body">
<p>The variance of an operator <span class="math inline">\(\hat{A}\)</span> is an important quantity that we will often encounter, and it is defined as <span id="eq-variance-op"><span class="math display">\[
\Delta^2 A = \sigma_A^2 = \langle A^2 \rangle - \langle A \rangle ^2.
\tag{3.33}\]</span></span></p>
<p>This is useful also to demonstrate uncertainty relations.</p>
</div>
</div>
<section id="exercise-1" class="level4" data-number="3.5.2.1">
<h4 data-number="3.5.2.1" class="anchored" data-anchor-id="exercise-1"><span class="header-section-number">3.5.2.1</span> <span style="color:#336699;">Exercise</span></h4>
<p>Calculate the expectation value <span class="math inline">\(\langle x \rangle\)</span> of a Gaussian wavefunction <span class="math inline">\(\psi(x)\)</span>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hints
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A Gaussian wavefunction has the form <span class="math inline">\(\psi(x)=\frac{1}{\sqrt{Z}}e^{-x^2/4\sigma^2}\)</span>, where <span class="math inline">\(1/Z\)</span> is the normalization factor for <span class="math inline">\(|\Psi|^2\)</span>.</p>
</div>
</div>
</div>
<details>
<summary>
Solution
</summary>
<p><span class="math display">\[
\langle x \rangle = \frac{1}{Z}\int_{-\infty}^{\infty} dx |e^{-x^2/4\sigma^2}|^2 = \frac{1}{Z}\int_{-\infty}^{\infty} dx e^{-x^2/2\sigma^2} = 0,
\]</span></p>
<p>because the function has odd symmetry.</p>
<p>Similarly, you can demonstrate that <span class="math inline">\(\langle x^2 \rangle = \sigma^2\)</span>. Do it as a homework!</p>
<p>We will evaluate expectation values quite a lot, and it will be useful to remember that the variance <span class="math inline">\(\Delta^ A\)</span> (or <span class="math inline">\(\sigma^(A)\)</span>) of an operator <span class="math inline">\(\hat{A}\)</span> is given by <a href="#eq-variance-op">Equation&nbsp;<span>3.33</span></a>.</p>
</details>
</section>
<section id="exercise-2" class="level4" data-number="3.5.2.2">
<h4 data-number="3.5.2.2" class="anchored" data-anchor-id="exercise-2"><span class="header-section-number">3.5.2.2</span> <span style="color:#336699;">Exercise</span></h4>
<p>Calculate the expectation value <span class="math inline">\(\langle p \rangle\)</span> of a Gaussian wavefunction <span class="math inline">\(\psi(x)\)</span>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hints
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<details>
<summary>
Hint 1
</summary>
The starting point is the same as the example above.
</details>
<details>
<summary>
Hint 2
</summary>
Be careful to the order, now it matters!
</details>
</div>
</div>
</div>
<details>
<summary>
Solution
</summary>
<p>– ADD SOLUTION – <!-- Slides 4, page 3 --></p>
</details>
</section>
</section>
<section id="eigenfunctions" class="level3" data-number="3.5.3">
<h3 data-number="3.5.3" class="anchored" data-anchor-id="eigenfunctions"><span class="header-section-number">3.5.3</span> Eigenfunctions</h3>
<p>Before we explain what eigenfunctions are, let’s refresh some good ol’ linear algebra stuff (please revise this as you will need it a lot!).</p>
<section id="remember-eigenvectors-and-eigenvalues" class="level4" data-number="3.5.3.1">
<h4 data-number="3.5.3.1" class="anchored" data-anchor-id="remember-eigenvectors-and-eigenvalues"><span class="header-section-number">3.5.3.1</span> Remember eigenvectors and eigenvalues?</h4>
<p>Let’s go back to some maths that you should know well, about matrices, eigenvectors and eigenvalues.</p>
<p>Consider a matrix <span class="math inline">\(\mathbb{A}\)</span> acting on a vector <span class="math inline">\(\mathbf{v}\)</span>. If <span id="eq-eigenvalue-eq"><span class="math display">\[
\mathbb{A}\mathbf{v}=\lambda\mathbf{v},
\tag{3.34}\]</span></span></p>
<p>with <span class="math inline">\(\lambda\)</span> a constant, then this is called the <strong>eigenvalue equation</strong>, where:</p>
<ul>
<li><span class="math inline">\(\mathbf{v}\)</span> is an eigenvector of <span class="math inline">\(\mathbb{A}\)</span>,</li>
<li><span class="math inline">\(\lambda\)</span> is the eigenvalue.</li>
</ul>
<p>What does this mean? It means that the application of the matrix <span class="math inline">\(A\)</span> on the vector <span class="math inline">\(v\)</span> returned the vector <span class="math inline">\(v\)</span> (in the same direction), but rescaled, with a scaling constant <span class="math inline">\(\lambda\)</span>.</p>
<p>You can check a visualization of this in the interactive resource embedded below, or found at <a href="https://www.st-andrews.ac.uk/physics/quvis/simulations_html5/sims/EigenvectorsAndEigenvalues/Eigenvectors_and_Eigenvalues.html">this link</a>.</p>
<iframe src="https://www.st-andrews.ac.uk/physics/quvis/simulations_html5/sims/EigenvectorsAndEigenvalues/Eigenvectors_and_Eigenvalues.html" id="iframe_container" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" allow="autoplay; fullscreen" height="450" width="700"></iframe>
</section>
<section id="eigenfunctions-and-eigenstates" class="level4" data-number="3.5.3.2">
<h4 data-number="3.5.3.2" class="anchored" data-anchor-id="eigenfunctions-and-eigenstates"><span class="header-section-number">3.5.3.2</span> Eigenfunctions (and eigenstates)</h4>
<p>Why do I dig out now the eigenvectors and eigenvalues stuff from the “forgotten-maths-I-thought-I-no-longer-needed” pit? (Spoiler: you will need this a lot…)</p>
<p>Because earlier I mentioned that the time-independet Schrödinger equation (<a href="#eq-TISE-H">Equation&nbsp;<span>3.24</span></a>) is an <em>eigenvalue equation</em>.</p>
<p>Compare this with the eigenvalue equation in <a href="#eq-eigenvalue-eq">Equation&nbsp;<span>3.34</span></a>. Do you see the similarities? Instead of having a matrix <span class="math inline">\(\mathbb{A}\)</span> and a vector <span class="math inline">\(\mathbf{v}\)</span>, we have an operator <span class="math inline">\(\hat{H}\)</span> and a wavefunction <span class="math inline">\(\psi(x)\)</span>, but the TISE tells me that if I apply the Hamiltonian operator <span class="math inline">\(\hat{H}\)</span> on the wavefunction <span class="math inline">\(\psi(x)\)</span>, I get the same wavefunction <span class="math inline">\(\psi(x)\)</span>, but <em>rescaled</em> by a real number which is given by the energy <span class="math inline">\(E\)</span>!</p>
<p>So in analogy with eigenvalues and eigenvectors, we can say that in the TISE <span class="math inline">\(\psi(x)\)</span> is an <strong>eigenfunction</strong> and <span class="math inline">\(E\)</span> is the <strong>eigenvalue</strong> (for the energy in this case).</p>
<p>In the previous section we saw two more examples of eigenvalue equations: <a href="#eq-p-eigenvalue">Equation&nbsp;<span>3.30</span></a> and <a href="#eq-E-eigenvalue">Equation&nbsp;<span>3.31</span></a>.</p>
<p>Below is a generalised definition of the eigenfunction, analogous to the one for eigenvectors given above. This is <em>very</em> important: the eigenfunctions satisfying eigenvalue equations are the building blocks of quantum states.</p>
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Eigenfunction
</div>
</div>
<div class="callout-body-container callout-body">
<p>An <strong>eigenfunction</strong> <span class="math inline">\(\psi\)</span> of an operator <span class="math inline">\(\hat{A}\)</span> is a wavefunction that respects the <em>eigenvalue equation</em></p>
<p><span id="eq-eigenfunction-eq"><span class="math display">\[
\hat{A}\psi = \lambda \psi,
\tag{3.35}\]</span></span></p>
<p>for some scalar <em>eigenvalue</em> <span class="math inline">\(\lambda\)</span>.</p>
<p>This means that the action of <span class="math inline">\(\psi\)</span> does not change the wavefunction itself, it only rescales it by some scalar value <span class="math inline">\(\lambda\)</span>.</p>
<p>Note that we use the term eigenfunction when we talk about wavefunctions in the <em>wave formalism</em> of QM, but we could also talk about <strong>eigenstates</strong>, which is usually referred to the same concept but in the matrix formalism of QM.</p>
</div>
</div>
</section>
</section>
</section>
<section id="sec-general-sol-TDSE" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="sec-general-sol-TDSE"><span class="header-section-number">3.6</span> General solution of the TDSE - expansion in energy eigenfunctions</h2>
<p>So now we are getting to the point… the TISE is an eigenvalue equation, and when we say that we want to <em>solve</em> it, for a given Hamiltonian, what we mean is that we want to find the set of eigenfunctions and eigenvalues for that Hamiltonian! But why is that important?</p>
<p>Now that we added some extra tools to our quantum toolbox, we can <em>expand on that</em> (pun intended, spoilers in the section title) and gain a better understanding of what we can extract from the Schrödinger equation and from its eigenfunctions and eigenvalues.</p>
<p>First, let’s get back to some properties of the stationary states. Given the TISE (<a href="#eq-TISE-H">Equation&nbsp;<span>3.24</span></a>), the expectation value of the total energy is <span class="math display">\[
\langle H\rangle = \int \psi^* H \psi dx = E \int |\psi|^2 dx = E,
\]</span></p>
<p>which results from the normalization of the wavefunction <span class="math inline">\(\psi(x)\)</span>. Nothing really new so far. Let’s now calculate the variance:</p>
<p><span class="math display">\[
\Delta H = \langle H^2 \rangle - \langle H \rangle^2 = E^2-E^2 = 0.
\]</span></p>
<p>What does it mean that the variance is 0? It means that every time we measure the energy on the eigenstate <span class="math inline">\(\psi\)</span>, the energy we find is going to be <em>always</em> exactly <span class="math inline">\(E\)</span>, because the variance of the measurement is 0! Now it is clear why we say that stationary state are states with a <em>well defined total energy</em>.</p>
<p>So it seems that stationary states are pretty boring after all: they have a well defined energy, their probability is not evolving with time, they only have a time-evolving global phase, and what do we even do with them? How can we describe any system that evolves with time and does not have a well determined energy? Remember how we opened this chapter, emphasising the importance of the superposition principle… this is going to give us something useful here.</p>
<p>Stationary states, or eigenstates, are not that useless after all, and this is because <em>the general time-dependent solution for any system can be obtained from a (weighted) sum of stationary states</em> - such a system will have <em>indeterminate energy</em>.</p>
<p>So, the TISE is useful because it gives a set of eigenvalues, <span class="math inline">\(E_1, E_2, E_3,...\)</span> and eigenstates, <span class="math inline">\(\psi_1(x), \psi_2(x), \psi_3(x),...\)</span>, from which we can obtain a (total) wavefunction for each allowed value of the energy, i.e. <span id="eq-eigenstates-list"><span class="math display">\[
\Psi_1(x,t)=\psi_1(x)e^{-iE_1t/\hbar},\quad \Psi_2(x,t)=\psi_2=(x)e^{-iE_2t/\hbar},\, ... .
\tag{3.36}\]</span></span></p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The eigenstates <span class="math inline">\(\psi_1(x), \psi_2(x), ...\)</span> of Hermitian operators are <em>orthogonal</em>, meaning that the projection, or <em>overlap</em>, of one on the other is zero, or in mathematical terms:</p>
<p><span id="eq-eigenstates-orthogonality"><span class="math display">\[
\int dx \psi_i(x)\psi_j(x) = \delta(i-j),
\tag{3.37}\]</span></span></p>
<p>so the integral is <span class="math inline">\(0\)</span> if <span class="math inline">\(i\neq j\)</span> and <span class="math inline">\(1\)</span> if <span class="math inline">\(i=j\)</span> (due to the normalization condition).</p>
</div>
</div>
<p>Now we can use the superposition principle to solve the TDSE, since if each of the wavefunction in <a href="#eq-eigenstates-list">Equation&nbsp;<span>3.36</span></a> is a solution of the TDSE, then a <em>linear combination</em> (i.e.&nbsp;weighted sum) of them is also a solution to the TDSE! We therefore obtain the <strong>general solution</strong> of the TDSE.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
General solution of the time-dependent Schrödinger equation
</div>
</div>
<div class="callout-body-container callout-body">
<p>Given a set of eigenstates <span class="math inline">\(\psi_i\)</span> and eigenvalues <span class="math inline">\(E_i\)</span> of the TISE, the general solution of the TDSE is given by the linear combination</p>
<p><span id="eq-TDSE-gen-sol"><span class="math display">\[
\Psi(x,t) = \sum_{n=1}^{\infty} c_n \psi_n(x)e^{-iE_nt/\hbar}=\sum_{n=1}^{\infty} c_n \Psi_n(x,t),
\tag{3.38}\]</span></span></p>
<p>where <span class="math inline">\(c_n\)</span> are the <strong>amplitudes</strong> - have the function of “weights” for the set of eigenfunctions - and need to be found to determine the correct general solution.</p>
<p>The general solution has <em>indeterminate energy</em> because the time evolution is not just a global phase now, there is <em>phase-interference</em> arising from the constituent stationary states.</p>
</div>
</div>
<p><a href="#eq-TDSE-gen-sol">Equation&nbsp;<span>3.38</span></a> means that the eigenfunctions <span class="math inline">\(\psi_n\)</span> constitute a <strong>complete basis</strong>, so every wavefunction at the time <span class="math inline">\(t=0\)</span> can also be represented as a weighted sum of the eigenstates: <span id="eq-TDSE-gen-sol-t0"><span class="math display">\[
\Psi(x,0) = \sum_{n=1}^{\infty} c_n \Psi_n(x,0).
\tag{3.39}\]</span></span></p>
<p>Since the time-dependance in the general solution of the TDSE <a href="#eq-TDSE-gen-sol">Equation&nbsp;<span>3.38</span></a> is not merely a global phase, the probability of the general state, <span class="math inline">\(|\Psi(x,t)|^2\)</span> is now going to be also time-dependent, in contrast with the probability of stationary states:</p>
<p><span id="eq-gen-prob-TDSE"><span class="math display">\[
\begin{aligned}
P(x,t) = |\Psi(x,t)|^2 &amp;= \sum_i c_i^* e^{iE_it/\hbar}\psi^*_i(x,0)\sum_j c_j^* e^{-iE_jt/\hbar}\psi^*_j(x,0) \\
&amp;= \sum_{i,j} c^*_i c_j e^{-i(E_j-E_i)t/\hbar}\psi^*_i(x)\psi_j(x).
\end{aligned},
\tag{3.40}\]</span></span></p>
<p>where you can now see that the <em>local</em> phases <span class="math inline">\(e^{-i(E_j-E_i)t/\hbar}\)</span> create interference.</p>
<p>The probability of <a href="#eq-gen-prob-TDSE">Equation&nbsp;<span>3.40</span></a> still has to be normalised (its integral must be one), i.e.&nbsp;<span class="math inline">\(\int P(x,t)dx=1\)</span>, and it follows that</p>
<p><span class="math display">\[
\int P(x,t)dx=\sum_{i,j} c^*_i c_j e^{-i(E_j-E_i)t/\hbar}\int dx \psi^*_i(x)\psi_j(x) = \sum_{i,j} c^*_i c_j e^{-i(E_j-E_i)t/\hbar} \delta(i-j) = 1,
\]</span></p>
<p>where we used the property of orthogonality of the eigenstates <span class="math inline">\(\psi_i\)</span> (cfr. <a href="#eq-eigenstates-orthogonality">Equation&nbsp;<span>3.37</span></a>). Therefore, imposing <span class="math inline">\(i=j\)</span>, the normalization condition reduces to the following normalization condition for the amplitudes:</p>
<p><span id="eq-normalization-amplitudes"><span class="math display">\[
\sum_i |c_i|^2 = 1.
\tag{3.41}\]</span></span></p>
<p>You can see get a better understanding of how the principle of superposition works by using the resource at <a href="https://www.st-andrews.ac.uk/physics/quvis/simulations_html5/sims/ExpansionTheorem/ExpansionTheorem.html">this link</a>, also embedded below. Given a general solution, we can express this as a sum of eigenstates, weighted by appropriate coefficients (tick the “show expansion in energy eigenfunctions box to see it”). There is also an “expansion game” where you can try to find the correct coefficients, given some wavefunctions!</p>
<iframe src="https://www.st-andrews.ac.uk/physics/quvis/simulations_html5/sims/ExpansionTheorem/ExpansionTheorem.html" id="iframe_container" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" allow="autoplay; fullscreen" height="450" width="700"></iframe>
<!-- #### Overlap of eigenfunctions

The eigenfunctions of an operator are linearly independent, meaning that one eigenfunction can't be obtained by linear combinations of others. However, they can be used to obtain any other functions, as we've seen.

The linear independence between two eigenstates $\psi_i$ and $\psi_j$ means that they are _orthogonal_, hence _their overlap is zero_, i.e.

$$
\int\psi_i^*(x)\psi_j(x)dx=0 \quad \mathrm{for} ~i\neq j.
$$

However, for a general solution $\Psi$ obtained by a weighted sum of eigenfunctions (@eq-TDSE-gen-sol-t0), the overlap of this with the eigenfunctions $\psi_i$ is not zero and returns the amplitudes $c_i$, i.e. $$
\int\psi_i(x)^*\Psi(x,0) dx = c_i$$ -->
</section>
<section id="commutators" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="commutators"><span class="header-section-number">3.7</span> Commutators</h2>
<p>Going back to operators, something important to know is that <strong>the order of the operators matter</strong>, and this property is reflected mathematically in the <strong>commutators</strong>.</p>
<p>In fact, we have already seen the importance of <em>commutation</em> when we stressed that in the expectation values, the ordering of the functions matters!</p>
<p>The commutator between two operators is defined as</p>
<p><span id="eq-commutator-def"><span class="math display">\[
[\hat{A},\hat{B}] = \hat{A}\hat{B} - \hat{B}\hat{A}.
\tag{3.42}\]</span></span></p>
<p>The order matters for both operators <em>and</em> wavefunctions.</p>
<p>If the commutator between two operators is non-zero, swapping the order of the two operators will result in different final wavefunctions: <span class="math display">\[
[\hat{A},\hat{B}]\neq 0 \implies (\hat{A}\hat{B})\psi \neq (\hat{B}\hat{A})\psi.
\]</span></p>
<p>If the commutator is zero, it does not matter which order we use to apply <span class="math inline">\(\hat{A}\)</span> and <span class="math inline">\(\hat{B}\)</span>, i.e. <span id="eq-zero-coommutator"><span class="math display">\[
[\hat{A},\hat{B}]=0\implies AB=BA.
\tag{3.43}\]</span></span></p>
<section id="properties-of-commutators" class="level3" data-number="3.7.1">
<h3 data-number="3.7.1" class="anchored" data-anchor-id="properties-of-commutators"><span class="header-section-number">3.7.1</span> Properties of commutators</h3>
<p>These properties are <em>very</em> important, please remember them, as they will be essential during the whole course, but they will also be your bread and butter in any other course tackling quantum mechanics applications next year.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important - Useful commutation relations
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Transpose</strong>: <span class="math inline">\([\hat{A},\hat{B}]=-[\hat{B},\hat{A}]\)</span></p>
<p><strong>Expansion:</strong> <span class="math inline">\([\hat{A}\hat{B},\hat{C}]=\hat{A}[\hat{B},\hat{C}]+[\hat{A},\hat{C}]\hat{B}\)</span></p>
<p><strong>Jacobi identity:</strong> <span class="math inline">\([\hat{A},[\hat{B},\hat{C}]+[\hat{B},[\hat{C},\hat{A}]]+[\hat{C},[\hat{A},\hat{B}]]=0\)</span>.</p>
<p><strong>Hermitian conjugate</strong>: <span class="math inline">\([\hat{A},\hat{B}]^{\dagger}=[\hat{B}^{\dagger},\hat{A}^{\dagger}]\)</span></p>
<p>The dagger symbol indicates the <em>transpose conjugate</em> - it makes more sense to use this name if we use the matrix formalism of QM instead of the wave formalism, but for the wave formalism consider the complex conjugate of the operators, so treat the <span class="math inline">\(\dagger\)</span> symbol as a <span class="math inline">\(*\)</span>.</p>
</div>
</div>
</section>
<section id="the-canonical-commutation-relation" class="level3" data-number="3.7.2">
<h3 data-number="3.7.2" class="anchored" data-anchor-id="the-canonical-commutation-relation"><span class="header-section-number">3.7.2</span> The canonical commutation relation</h3>
<p>An example of non-commuting operators is given by the conjugate variables <span class="math inline">\(\hat{x}\)</span> and <span class="math inline">\(\hat{p}_x\)</span>, which is particularly important, so important that it has its own name: the <strong>canonical commutation relation</strong>.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Canonical commutation relation
</div>
</div>
<div class="callout-body-container callout-body">
<p>In 1D:</p>
<p><span id="eq-canon-comm-rel-1D"><span class="math display">\[
[\hat{x},\hat{p}_x]=i\hbar.
\tag{3.44}\]</span></span></p>
<p>More generally, indicating with subscripts <span class="math inline">\(i,j,k\)</span> the different directions for coordinates and momenta in 3D, we have: <span id="eq-canon-comm-rel-3D"><span class="math display">\[
[\hat{r}_i,\hat{p}_i]=i\hbar, \quad [\hat{r}_i,\hat{p}_j]=0\quad \mathrm{for} i\neq j
\tag{3.45}\]</span></span> <span id="eq-comm-rel-rr-pp"><span class="math display">\[
[\hat{r}_i,\hat{r}_j]=0, \quad [\hat{p}_i,\hat{p}_j]=0\quad \forall i,j
\tag{3.46}\]</span></span></p>
</div>
</div>
</section>
<section id="the-generalised-uncertainty-principle" class="level3" data-number="3.7.3">
<h3 data-number="3.7.3" class="anchored" data-anchor-id="the-generalised-uncertainty-principle"><span class="header-section-number">3.7.3</span> The generalised uncertainty principle</h3>
<p>The uncertainty for position and momentum can be formalised into a very important result between other pairs of conjugate variables. We will skip the demonstration of how to get to this result here (it is in the slides if you are curious), but the <strong>generalised uncertainty principle</strong> for two <em>incompatible</em> operators <span class="math inline">\(\hat{A}\)</span> and <span class="math inline">\(\hat{B}\)</span> is:</p>
<p><span id="eq-generalised-uncertainty-rel"><span class="math display">\[
\Delta A \Delta B \geq \frac{1}{2i} |\langle [\hat{A},\hat{B}] \rangle |
\tag{3.47}\]</span></span></p>
</section>
<section id="exercise-3" class="level3" data-number="3.7.4">
<h3 data-number="3.7.4" class="anchored" data-anchor-id="exercise-3"><span class="header-section-number">3.7.4</span> <span style="color:#336699;">Exercise</span></h3>
<p>Demonstrate the canonical commutator of <a href="#eq-canon-comm-rel-1D">Equation&nbsp;<span>3.44</span></a>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hints
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Consider the commutator applied to a generic wavefunction <span class="math inline">\(\psi(x)\)</span> in 1D, and use the form of the momentum operator.</p>
</div>
</div>
</div>
<details>
<summary>
Solution
</summary>
<p>Let’s start with the commutator applied to a wavefunction <span class="math inline">\(\psi(x)\)</span> in 1D: <span class="math display">\[
[\hat{p}_x,\hat{x}]\psi(x)=(\hat{p}_x \hat{x}-\hat{x}\hat{p}_x) \psi(x).
\]</span></p>
<p>To lighten the notation and avoid misunderstandings, in the following I write <span class="math inline">\(\psi(x)\)</span> as <span class="math inline">\(\psi\)</span>, so the <span class="math inline">\(x\)</span>-dependance is implicit.</p>
<p>Using the momentum operator definition of <a href="#eq-momentum-op">Equation&nbsp;<span>3.11</span></a>:</p>
<p><span class="math display">\[
[\hat{p}_x,\hat{x}]\psi = -i\hbar \left( \frac{\partial}{\partial x}(x\psi) - x \frac{\partial}{\partial x}\psi \right) = -i\hbar \left( \frac{\partial x}{\partial x}\psi +x \frac{\partial}{\partial x}\psi - x \frac{\partial}{\partial x}\psi \right) = -i\hbar \psi.
\]</span></p>
<p>Using the transpose properties of the commutators, then <span class="math display">\[
[\hat{p}_x,\hat{x}] = -i\hbar \implies [\hat{x},\hat{p}_x]=i\hbar.
\]</span></p>
</details>
</section>
</section>
<section id="time-evolution-of-expectation-values" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="time-evolution-of-expectation-values"><span class="header-section-number">3.8</span> Time evolution of expectation values</h2>
<p>We have seen the time-evolution of stationary state wavefunctions (<a href="#eq-stationary-state">Equation&nbsp;<span>3.27</span></a>) and the directly related probability densities; now we wish to see how these map into the time evolutions of expectation values, for values which may or may not share a compatible eigenstate basis with the Hamiltonian. Taking the time-derivative of an expectation value and being careful (as ever) to apply to product rule correctly, the key result is shown below.</p>
<p><span class="math display">\[
\frac{d\langle\hat{A}\rangle}{dt}=\frac{d}{dt}\int dx \Psi^* \hat{A} \Psi  = \int \frac{\partial \Psi^*}{\partial t}  \hat{A} \Psi + \int dx \Psi^*  \frac{\partial \hat{A}}{\partial t} \Psi + \int dx \Psi^* \hat{A} \frac{\partial \Psi}{\partial t}
\]</span></p>
<p>Using the TDSE (<a href="#eq-TDSE-H">Equation&nbsp;<span>3.12</span></a>), we can cast the above equation in the form <span class="math display">\[
\begin{aligned}
\frac{d\langle\hat{A}\rangle}{dt}&amp;=-\frac{1}{i\hbar} \int dx (\hat{H}\Psi)^* \hat{A} \Psi + \int dx \Psi^* \frac{\partial \hat{A}}{\partial t} \Psi + \frac{1}{i\hbar} \int dx \Psi^* \hat{A} \hat{H}\Psi\\
&amp;= \frac{1}{i\hbar} \int dx \Psi^* (AH-HA)\Psi + \int dx \Psi^* \frac{\partial \hat{A}}{\partial t} \Psi,
\end{aligned}
\]</span></p>
<p>and using the definition of the commutator (<a href="#eq-commutator-def">Equation&nbsp;<span>3.42</span></a>), we finally obtain:</p>
<p><span id="eq-expectation-value-evolution"><span class="math display">\[
\frac{d\langle\hat{A}\rangle}{dt}=\frac{1}{i\hbar}\langle [\hat{A},\hat{H}] + \left\langle \frac{\partial A}{\partial t} \right\rangle.
\tag{3.48}\]</span></span></p>
<p>This means that the rate of change of an expectation value is proportional to the commutator of its operator and the Hamiltonian operator <span class="math inline">\(\hat{H}\)</span>, plus the time-dependence of the measurement operator itself. The second term in <a href="#eq-expectation-value-evolution">Equation&nbsp;<span>3.48</span></a> is usually zero: the most obvious way to introduce it would be for the system environment to time-evolve, e.g.&nbsp;for <span class="math inline">\(U(r,t)\)</span> to be time-dependent, which we don’t consider in this course.</p>
<p>For “normal” time-independet operators, the driver of change in expectation values is whether the operator <span class="math inline">\(\hat{A}\)</span> commutes with the Hamiltonian: this makes intuitive sense since if the operator <span class="math inline">\(\hat{A}\)</span> and the Hamiltonian are compatible, then the stationary states will be eigenstates of <span class="math inline">\(\hat{A}\)</span> and hence the expectation value will also be stationary, i.e.</p>
<p><span class="math display">\[
[H,A]=0\implies H(A\Psi)=A(H\Psi) \implies H(A\Psi)=E A\Psi
\]</span></p>
<p>and since the TISE needs to be satisfied, we need <span class="math inline">\(A\Psi=\lambda\Psi\)</span>.</p>
<p>In short, what does this mean? <em>The commutation of an operator with the Hamiltonian implies time-invariance.</em></p>
<section id="the-ehrenfest-theorem-and-the-correspondence-principle" class="level3" data-number="3.8.1">
<h3 data-number="3.8.1" class="anchored" data-anchor-id="the-ehrenfest-theorem-and-the-correspondence-principle"><span class="header-section-number">3.8.1</span> The Ehrenfest theorem and the correspondence principle</h3>
<p>At the beginning of the course we said that, in the classical limit, i.e.&nbsp;when we recover the probability distribution after many repetitions of the experiment, and take the average of the physical quantities observed, quantum mechanics should return the classical physics predictions.</p>
<p>We have introduced the expectation values and have seen that physically these correspond to the value that on average we would obtain after repeating a measurement many times, and the standard deviation corresponds to the width of the distribution of the measurement outcomes around the expectation value. We can then guess that if we evaluate the time evolution of the expectation value for some quantities (e.g.&nbsp;position or momentum operators), we should obtain the classical equations of motion for those quantities. Let’s see this.</p>
<p>If we apply <a href="#eq-expectation-value-evolution">Equation&nbsp;<span>3.48</span></a> to the operators <span class="math inline">\(\hat{A}=\hat{x}\)</span> and <span class="math inline">\(\hat{A}=\hat{p}\)</span>, considering their commutators with the non-relativistic Hamiltonian (<a href="#eq-hamiltonian-op">Equation&nbsp;<span>3.10</span></a>) <span id="eq-comm-x-H"><span class="math display">\[
[\hat{x},\hat{H}]=[\hat{x},\hat{p}^2/2m+U(x)]=[\hat{x},\hat{p}^2/2m],
\tag{3.49}\]</span></span> <span class="math display">\[
[\hat{p},\hat{H}]=[\hat{p},\hat{p}^2/2m+U(x)]=[\hat{p},U(x)],
\]</span> using the commutation properties, we obtain:</p>
<p><span class="math display">\[
\frac{d\langle x \rangle}{dt}=\frac{1}{2i\hbar m}\langle [\hat{x},\hat{p}^2]\rangle = \frac{1}{2i\hbar m}\langle \hat{p}[\hat{x},\hat{p}]+[\hat{x},\hat{p}]\hat{p}\rangle = \frac{1}{2i\hbar m}\langle 2i\hbar\hat{p} \rangle,
\]</span></p>
<p>which generalised to 3D is</p>
<p><span id="eq-newtonian-momentum"><span class="math display">\[
\langle \mathbf{p} \rangle = m\frac{d\langle \mathbf{r}\rangle}{dt}.
\tag{3.50}\]</span></span></p>
<p>Similarly, for the time evolution of the momentum expectation value, we obtain: <span id="eq-newtons-2nd-law"><span class="math display">\[
\frac{d\langle \mathbf{p} \rangle}{dt} = -\langle \nabla U \rangle,
\tag{3.51}\]</span></span></p>
<p>which is Newton’s second law!</p>
<p>This recovery of classical dynamics in the expectation values of quantum mechanics is <strong>Ehrenfest’s Theorem</strong>. It is an important example of the general correspondence principle introduced by Bohr in his first nuclear-atom construction, which applied to large atomic number Z: that in the large-system statistical limit, quantum mechanics is consistent with classical physics.</p>
<p>QM is the fundamental physics, with classical behaviours being a handy approximation in systems where quantum features like wavefunction collapse and amplitude interference are “washed out” by the incoherent superposition of many different contributions to the total wavefunction.</p>
<p>Only a few special systems such as carefully prepared superfluids and Bose-Einstein condensates are able to propagate quantum effects to macroscopic scales — although the consequences of fundamentally quantum effects are immensely important in ensuring a few trifling details like the stability of matter, the distribution of structure in the universe, and solar fusion.</p>
</section>
</section>
<section id="summary" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="summary"><span class="header-section-number">3.9</span> Summary</h2>
<ul>
<li>In general the Hamiltonian is the generator of time-evolution for a (quantum) system.</li>
<li>A state of definite energy is an eigenstate of the Hamiltonian, and its time-evolution is just a phase <span class="math inline">\(\propto Et/\hbar\)</span>.</li>
<li>For time-independent potentials, the time-independent Schrödinger equation can be obtained from the time-dependent one; obtain stationary states by assuming wavefunction separable into <span class="math inline">\(r\)</span> and <span class="math inline">\(t\)</span> parts.</li>
<li>The TISE is an eigenvalue equation, and the corresponding eigenfunctions and eigenfunctions are used to obtain stationary states.</li>
<li>The general solution for the TDSE can be obtained from a linear combination of the stationary states with a definite energy.</li>
<li>Wavefunctions must be square-integrable, continuous everywhere, and smooth except at infinite potential steps.</li>
<li>Expectation values also time-evolve with the Hamiltonian: static operators which commute with the Hamiltonian have time-invariant expectation values.</li>
<li>Ehrenfest’s theorem results from this: expectation values of position and momentum obey Newton’s Laws, cf.&nbsp;correspondence principle.</li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-bransden1989introduction" class="csl-entry" role="listitem">
Bransden, Brian Harold, and Charles Jean Joachain. 1989. <span>“Introduction to Quantum Mechanics.”</span>
</div>
<div id="ref-griffiths2019introduction" class="csl-entry" role="listitem">
Griffiths, David J, and Darrell F Schroeter. 2019. <em>Introduction to Quantum Mechanics</em>. Cambridge university press.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./p3qm-2.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Wavefunctions and the uncertainty principle</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./p3qm-4.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Solutions of Schrödinger Equations in 1D - Bound states</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>