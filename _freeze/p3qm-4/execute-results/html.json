{
  "hash": "82b95ef65f8dfe602080a5c713333ae4",
  "result": {
    "markdown": "---\ntitle: Solutions of Schrödinger Equations in 1D - Bound states\nauthor:\n  name: Dr Rosaria Lena\n  affiliation: rosaria.lena@glasgow.ac.uk\ndate: last-modified\ndate-format: long\naffiliation-title: email\ndescription: _Lectures 9-12_ - use _Bransden-Joachain_ Ch.3 and _Griffiths_ Ch.2 for reference\ntitle-block-banner: true\nexecute:\n  echo: true\n  freeze: auto\n---\n\n## __Learning objectives__ {.unnumbered}\n\n1. Understanding the procedure to find the general solution of the TDSE\n\n2. Understanding the difference between bound and scattering states\n\n3. Calculating the eigenfunctions of the TISE for different potentials in 1D, i.e. infinite well, square well, delta well, harmonic well\n\n4. Executing calculations of expectations values of operators on eigenstates and their combinations, for different potentials\n\n5. Familiarising yourself with the Dirac (bra-ket) notation\n\n-----------\n\n\n## Solving a general problem with the TDSE\n\nIn this Chapter we will focus on solving the Schrödinger equation for different kinds of potential, in one dimension. Let's recap some of the things we've seen in the previous chapter.\n\nThe general problem that we will encounter in this course is the following:\n_given a time-independent potential $U(x)$ and the initial wavefunction $\\Psi(x,0)$, find the wavefunction $\\Psi(x,t)$ at any following time._\n\nThe strategy for this kind of problem is the following:\n\n1. Solve the _time-independent Schrödinger equation_ (@eq-TISE) to find the eigenstates $\\psi_n(x)$ and eigenvalues $E_n(x)$;\n\n2. With the eigenstates, \"reproduce\" $\\Psi(x,0)$ using the superposition principle, i.e.\n\n$$\n\\Psi(x,0)=\\sum_{n=1}^{\\infty} c_n\\psi_n(x),\n$$\n\nwith the appropriate amplitudes $c_n$.\n\n3. Build the stationary states from the eigenstates and eigenvalues found at the first step\n$$\n\\Psi_n(x,t) = \\psi_n(x)e^{-iE_nt/\\hbar},\n$$\n\nand use the superposition principle to find the general time-dependent Schrödinger equation (@eq-TDSE-gen-sol), i.e.\n$$\n\\Psi(x,t) = \\sum_{n=1}^{\\infty} c_n \\psi_n(x)e^{-iE_nt/\\hbar}=\\sum_{n=1}^{\\infty} c_n \\Psi_n(x,t).\n$$\n\n\nIn the rest of this course we will focus on the first two points, i.e. how to solve _time-independent_  Schrödinger equations, as unfortunately we do not have enough time to deal with time evolution\n(ironically the structure of the course is time-dependent... _\\*ba-dum-ts\\*_).\n\n## Solving the TISE\n\nBefore going ahead and solving the 1D TISE with different potentials, let's see what are the conditions we need to impose to have physical solutions and what their characteristics are, both for the eigenfunctions and energy eigenvalues.\n\n### Properties of the eigenfunctions\n\nLet's rewrite the 1D TISE (@eq-TISE):\n\n$$\n-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi}{dx^2}+U(x)\\psi(x)=E\\psi(x)\\implies \\frac{d^2\\psi}{dx^2}=-\\frac{2m}{\\hbar^2}[E-U(x)]\\psi(x).\n$${#eq-TISE_E-U}\n\nFrom the RHS of the last equation we can make some observation based on the sign of $E-U(x)$ and its effect on the curvature of the wavefunction (since the sign of the second derivative defines whether a function is concave or convex):\n\n- $E-U(x)>0 \\implies E>U(x)$ - _classically allowed region_; the wavefunction solution of the SE bends toward the $x$ axis; _wavelike solutions_\n- $E-U(x)<0 \\implies E<U(x)$ - _classically forbidden region_; the solution of the SE curves away from the $x$ axis; _exponential solutions_\n- $E=U(x)$ - _turning points_.\n\nWhen solving the SE for any given potential, remember the following conditions for the wavefunctions, that we've been stressing in the previous chapters:\n\n- __single-valued__ (i.e. for each value of $x$ (and $t$) there is only one corresponding value of $\\Psi$)\n- __continuous__ (i.e. you could \"draw\" it without lifting your pen from the paper)\n- __smooth__ _except at infinite-sized potential steps_ (i.e. no sudden changes in the derivative - continuous first derivatives _if there are no singularities in the potential_)\n\nOn top of these, impose the normalization condition.\n\nIn the following of this chapter we will apply these fundamental rules to the SEs for different (easy - and useful) potentials.\n\n\n### Properties of the eigenenergies - Bound states and scattering states\n\nThe set of values of the total energy, $E$, for which the TISE has physically admissible solutions, determines the __energy spectrum__.\n\nThe Schrödinger equation has two kind of solutions: _bound states_ and _scattering states_.\nTheir definition in quantum physics is a bit more \"relaxed\" from the one in classical physics, due to the effect of _tunneling_ through any finite potential barrier, which we will see later.\n\nIn classical physics, bound states and scattering states are defined comparing the total energy to the potential energy in an interval: if there are turning points ($E=U(x)$ for some $x$ - the kinetic energy is $0$), then the system is in a bound state in the interval between turning points; otherwise it is in a scattering state (see @fig-bound-scattering-classical).\n\n![Bound and classical states in classical physics.](img/scattering-bond-classical.jpg){width=110% #fig-bound-scattering-classical}\n\nThe definition of bound states in quantum physics is a bit more \"relaxed\" from the one in classical physics, due to the effect of _tunneling_ through any finite potential barrier, which we will discuss later.\nOverall we have a similar condition as for classical bound states but, instead of using the turning points, we compare the total energy with the potential $U(+\\infty)$ and $U(-\\infty)$.\n\n__Bound states__\n\n_Bound states_ satisfy the condition: $E<U_{\\pm\\infty}$\n\n- Classically they cannot \"escape\" to infinity, and even with quantum relaxation of that rule (as we shall see), the probability density will be localised at least close to the classically allowed $E > U$ part of the potential.\n- The energies of bound states are _quantised_ (or _discrete_).\n- The lowest discrete energy level is called the _ground-state energy_ of the system, and all the higher discrete energy levels are called _excited states_.\n- The eigenfunctions of bound states vanish for $\\mathbf{r}\\to\\infty$.\n- The number of bound state is finite (including $0$) or infinite, depending on the form of the potential $U$.\n\nFurthermore, bound states are real valued function (with global phases), so their probability flux $\\mathbf{J}\\propto \\psi^*\\nabla \\psi'^ -\\psi\\nabla\\psi^*$ must be zero.\n\n__Scattering (or unbound) states__\n\n_Scattering (or unbound) states_ are obtained if: $E>U_{\\pm\\infty}$.\n\n- The energies of unbound states are such that the particle would be also classically unbound\n- The energies of scattering states are _continuous_ and can extend to $E=+\\infty$\n- Since the energies form a continuum, there is no energy quantisation for scattering states\n- The eigenfunctions of unbound states are finite for $\\mathbf{r}\\to\\infty$.\n\n@fig-bound-scattering represents an example of potential with both bound and unbound states.\n\n![Example of an energy spectrum containing both bound states (discrete energy levels) and scattering states (continuum energies).](img/bound-scattering.jpg){#fig-bound-scattering}\n\n\nNow that we know what to expect to find for the energy eigenvalues and eigenfunctions in the solution of the TISE, let's go ahead and solve this for some potentials in one dimension.\n\nIn the following of this chapter we will be looking at _bound state solutions_ for one-dimensional _potential wells_.\n\n__Well, well, well...__\n\n![...look what we have here.](img/well-well-well.jpg){width=50%}\n\n## The infinite well potential (particle in a box)\n\nThe potential for the infinite potential well has the following form:\n\n$$\nV=\n\\begin{cases}\n0\\quad \\text{for} \\quad -a\\leq x\\leq a, \\\\\n\\infty \\quad \\text{elsewhere},\n\\end{cases}\n$${#eq-infinite-potential-well}\n\nrepresented in @fig-inf-pot-well.\n\n![Infinite well potential. In this picture, $L=2a$, if we refer to the definition in @eq-infinite-potential-well, and $U(x)=V(x)$.](img/inf-potential-well.png){width=60% #fig-inf-pot-well}\n\nOutside the potential well the probability of finding the particle is zero, hence $\\psi(x)=0$ for $x<-a, x>a$.\n\nThis means that inside the well, the particle behaves like a free particle, since in @eq-TISE the potential $U(x)$ is zero in the range $[-a,a]$:\n\n$$\n-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi(x)}{dx^2}=E\\psi(x).\n$$\n\nWe can rewrite this in the form\n$$\n\\frac{d^2\\psi(x)}{dx^2}=-k^2\\psi(x),\n$${#eq-diff-eq-inf-well}\nwhere we defined $k=\\sqrt{2mE}/\\hbar$, implicitly imposing $E>0$.\n\nSince the potential is flat within the well, we can show that plane waves (of any $k$) are good solutions to the Schrödinger's equation.\n\nWe could write these as a continuous spectrum of waves of given positive $k$,\n$$\n\\psi_k(x)=a_xe^{ikx}+b_ke^{-ikx},\n$$\n\nbut we can just expand this and reparametrise it in terms of $\\cos(kx)$ for $a_k=b_k$ and $\\sin(kx)$ for $a_k=-b_k$, for convenience, given the boundaries of the potential.\n\nSo the easiest solution to the differential equation of @eq-diff-eq-inf-well is\n$$\n\\psi_k(x) = A_k\\cos(kx)+B_k\\sin(kx).\n$${#eq-gen-sol-inf-well}\n\nWhat next? We need to consider the _boundary conditions_ of the function.\n\nWe know that the wavefunction must be _continuous_ and we know that outside the well it is zero, so we need to impose that at the boundaries $x=-a$ and $x=+a$ the wavefunction must also be zero:\n$$\n\\psi(\\pm a)=0.\n$${#eq-bc-inf-well}\n\nFrom @eq-gen-sol-inf-well, using the symmetry of the functions\n$$\n\\begin{cases}\n\\psi_k(-a)=A_k\\cos(-ka)+B_k\\sin(-ka)=0 \\implies A_k\\cos(ka)-B_k\\sin(ka)\\\\\n\\psi_k(a)=A_k\\cos(ka)+B_k\\sin(ka)=0,\n\\end{cases}\n$${#eq-psi_k-inf-well}\n\nsolving this system we obtain\n$$\n\\begin{aligned}\nA_k\\cos(ak)&=0\\implies k=\\frac{n\\pi}{2a}, \\quad \\mathrm{for}\\,\\, n=1,3,5...\\\\\nB_k\\sin(ak)&=0\\implies k=\\frac{n\\pi}{2a}, \\quad \\mathrm{for} \\,\\, n=2,4,6...\\\\\n\\end{aligned}\n$$\n\nSo replacing these values of $k$ in the wavefunctions of @eq-psi_k-inf-well, we obtain even/odd pairs of eigenfunctions $\\psi_n(x)$, which we define using the notation below:\n$$\n\\psi_n(x)=\n\\begin{cases}\nu(x)^+_n=A\\cos\\frac{n\\pi x}{2a} \\quad \\mathrm{for}\\,\\, n=1,3,5... \\\\\nu(x)^-_n=B\\sin\\frac{n\\pi x}{2a} \\quad \\mathrm{for}\\,\\, n=2,4,6...\n\\end{cases}\n$${#eq-eigenstates-inf-well-unnormalised}\n\nNote that now we have a discrete set of even and odd states! But wait, for the free particle we have a continuum of energy levels (unbound state), so what is different here, if we are assuming that within the well the particle can be considered a free particle, after all? The difference is... the boundaries! The lost of the continuous $k$ spectrum and appearance of a discrete spectrum is due to the fact that we are in fact imposing that at the boundaries, and outside those, the wavefunction is zero!\n\nThis has another consequence: remember when we said that the free particle represented as a plane wave had a big normalization problem because fully delocalised? Well, it looks like we do not have a fully delocalised particle after all, because we put infinite walls so we cheated the system, and now we can actually impose the normalization condition to find the constants $A$ and $B$ in @eq-eigenstates-inf-well-unnormalised, by imposing $\\int_{-\\infty}^{\\infty} \\psi_n(x)dx=\\int_{-a}^a\\psi_n(x)dx=1$.\n\nFor odd $n$:\n$$\n\\int_{-a}^a dx u(x)_n^+=\\int_{-a}^a A^2\\cos(n\\pi x/2a) dx =A^2 a [1+\\sin(n\\pi)/(n\\pi)] = 1 \\implies A=1/\\sqrt{a}.\n$$\n\nFor even $n$:\n$$\n\\int_{-a}^a dx u(x)_n^-=\\int_{-a}^a B^2\\sin(n\\pi x/2a) dx =A^2 a [1-\\sin(n\\pi)/(n\\pi)] = 1 \\implies B=1/\\sqrt{a}.\n$$\n\nTherefore the normalised eigenstates of the infinite well potential are as follows.\n\n:::{.callout-note icon=\"false\"}\n\n## Eigenstates for the infinite square potential well\n\n$$\n\\psi_n(x)=\n\\begin{cases}\nu(x)^+_n=\\frac{1}{\\sqrt{a}}\\cos\\frac{n\\pi x}{2a} \\quad \\mathrm{for}\\,\\, n=1,3,5... \\\\\nu(x)^-_n=B\\sin\\frac{n\\pi x}{2a} \\quad \\mathrm{for}\\,\\, n=0,2,4...\n\\end{cases}\n$${#eq-eigenstates-inf-well}\n\n:::\n\nThe eigenvalues of the energy, below, are derived from $E_k =  \\frac{\\hbar^2k^2}{2m}$, with $k=\\frac{n\\pi}{2a}$.\n\n:::{.callout-note icon=\"false\"}\n\n## Eigenenergies for the infinite square potential well\n$$\nE_n^{\\pm} = \\frac{\\hbar^2\\pi^2}{8a^2m}n^2= \\frac{\\hbar^2\\pi^2}{2L^2m}n^2,\\quad \\mathrm{for}\\,\\, n=1,2,3,...\n$${#eq-eigenenergies-inf-well}\n\nwhere in the last passage we used $L=2a$ for the length of the well. \n\nNotice that $n=0$, and therefore $E=0$ is not allowed, as the particle can never be at rest.\nThe lowest allowed energy is the _ground state energy_, or _zero-point energy_, \n$$\nE_1 = \\frac{\\hbar^2\\pi^2}{8a^2m},\n$$\n\nand for $n>1$ we get the _excited states_.\n\n:::\n\nThe existence of the zero-point energy is due to the fact that in this case the particle can't be _fully delocalised_ as for the free particle case, because the wavefunction can't extend over the boundaries, so the momentum must have some uncertainty and can't be exactly zero.\n\nBut hang on, where did this “$\\psi=0$ if $U = \\infty$” rule come from? We will get a proper answer when we come to the delta-function well, but in short it is because of the infinite “energy penalty” on the particle should it penetrate the wall: the wavefunction will be forced to look like a decaying exponential with decay length ∼ 1/V = 0. In the following section we will set up the potentials differently, so the energy penalty (actually V − E) and hence the amplitude decay length are finite.\n\nNotice also that the eigenenergies are proportional to $n^2$, so they are not equally spaced: their distance increases with $n$.\n\nA representation of the eigenstates and eigenenergies is shown in @fig-inf-well-sols.\n\n![Eigenfunctions (solid lines) and eigenenergies (dotted lines) for the infinite well potential. Warning: these diagrams visually mix energy levels and wavefunctions. Each eigenfunction is drawn with its zero level at the height of the corresponding energy.](img/squarewell-inf-solns2.png){#fig-inf-well-sols}\n\nIn the form we’re using, with $x = 0$ at the centre of the well, the solutions alternate between $cos(nπx/2a)$ and $sin(nπx/2a)$ functions, with $cos(πx/2a)$ as the even-symmetric ground state. That ground state wavefunctions have no zero-crossings (the $x = \\pm a$ endpoints do not count) is a general feature of energy eigenstates, with each excited state adding one crossing.\n\n:::{callout-caution}\n\nWe could have defined the wavefunction in the interval $[0,L]$ instead of $[-a,a]$. Note that in that case we would start with the same solution @eq-gen-sol-inf-well, but the eigenstates would be different and have only \"sine\" terms, due to the different boundary conditions determining different values of $A$ and $B$!\nThe reason why we defined these boundaries here is to use the symmetry property around the center of the well (we'll discuss this a bit further in the section on \"parity\".)\n\n:::\n\n### Properties of infinite-square-well potential eigenfunctions\n\n1. Normalization (we demonstrated this to derive $A, B$): $\\int_{-\\infty}^\\infty dx u(x)_n^{\\pm *} u(x)_n^{\\pm } = 1$\n2. Orthogonality: $\\int_{-\\infty}^\\infty dx u(x)_n^{\\pm *} u(x)_m^{\\mp } = 0; \\, \\int_{-\\infty}^\\infty dx u(x)_n^{\\pm *} u(x)_m^{\\pm } = \\delta_{mn}$ \n3. Eigenstates of $\\hat{H}, \\hat{p}^2$, but not e.g. $\\hat{p},\\hat{x}$\n4. Expectation values: $\\langle x \\rangle = 0, \\langle p \\rangle = 0, \\langle p^2\\rangle = 2mE_n^{\\pm}.$\n\n:::{.callout-caution}\n\nNote that because of the orthogonality property there is no overlap between eigenstates, but there can be overlap between linear combinations of them. Changing $|a|$ will generally mix the eigenstates!\n:::\n\n#### <span style=\"color:#336699;\">Exercise</span>\n\nDemonstrate the properties at points 3. and 4. above.\n\n:::{.callout-tip collapse=true}\n## Hints\n<details>\n<summary>Hint 1</summary>\nUseful relations:\n\n$$\n\\begin{aligned}\n&\\sin^2(A) + \\cos^2(A) = 1\\\\\n&\\sin^2(A) = \\tfrac{1}{2} [1 - \\cos(2A)] \\\\\n&\\cos^2(A) = \\tfrac{1}{2} [1 + \\cos(2A)]\\\\\n    &\\cos(A \\pm B) = \\cos(A)\\cos(B) \\mp \\sin(A)\\sin(B)\\\\\n    &\\sin(A \\pm B) = \\sin(A)\\cos(B) \\pm \\cos(A)\\sin(B)\\\\\n    % \\color{gray} \\to \\text{use}~\\cos(A+B) \\pm \\cos(A-B),~\\text{and}~\\sin(A+B) \\pm \\sin(A-B)\n\\end{aligned}\n$$\n</details>\n<details>\n<summary>Hint 2</summary>\n\nUse $\\cos(A+B) \\pm \\cos(A-B), ~\\text{and}~\\sin(A+B) \\pm \\sin(A-B)$.\n</details>\n\n:::\n\n<details>\n<summary> Solution </summary>\n\n-- No solution added (yet) --\n</details>\n\nA good exercise is to show that the stationary states do not have definite momentum or position, by application of the $\\hat{p}$ and $\\hat{x}$ operators: you can easily show that their expectation values are zero, consistent with the symmetry of the well. It may seem strange to not be in a definite-momentum state, especially since the Hamiltonian within the well contains only the kinetic energy term, $\\hat{p}^2/2m$, which commutes with $\\hat{p}$: this is because the sinusoidal solutions always contain equal amounts of positive and negative x, i.e. right-going and left-going momenta at the same time. They do, however, have non-zero $\\langle x^2 \\rangle$ and $\\langle p^2 \\rangle$ expectations.\n\n\nAs stationary states are eigenstates (of the Hamiltonian), they form an orthonormal basis (check this!) from which arbitrary states can be constructed by superposing different stationary states with different mixturers of (complex) coefficients (check again the interactive material of @sec-general-sol-TDSE) — subject to the overall probability-normalisation $\\int |\\psi|^2dx = 1$ requirement, of course.\n\nThe overlap coefficients can be extracted via the $c_n = \\int\\psi^*\\phi_n dx$ overlap integrals as usual, and the probabilities of a measurement collapsing into any particular eigenstate given by the mod-square of its coefficient, $P(n) = |c_n|^2$.\n\nIt is interesting to note that this (as do all such syntheses from stationary basis states) leads to wavefunctions of _indefinite energy_: this feels strange, and perhaps at odds with energy conservation, although we would find that that rule resumes nicely if we compute expected energy. This is a hint that a complete picture of relativistic energy and momentum conservation in QM is a bit more complex than we are ready to deal with!\n\n\n### Parity\n\nParity, i.e. the reflection symmetry $x\\to -x$ is an useful symmetry, and by choosing to place the zero coordinate along $x$ in the middle of the potential well, we obtained wavefunctions that respect the same symmetry, being even-symmetric under the parity transformation $x\\to -x$.\n\nThe stationary states are also eigenstates of the parity operator $\\hat{P}$, i.e. $\\hat{P}\\psi(x)=\\psi(-x)=\\pm 1$ (it has only two possible eigenvalues).\n\n\n\nThe spatial eigenstates $u^\\pm_n(x)$ have definite __parity__, and we can see that by applying the parity operator $\\hat{P}$ on them\n$$\n\\hat{P} u^+_n(x) = u^+_n(x); \\qquad \\hat{P} u^-_n(x) = -u^-_n(x)\n$${#eq-parity-eigenstates-inf-well}\n\nThe eigenstate alternate between parity $+1$ for the $\\cos$ solutions, and parity $−1$ for the $\\sin$ ones. Potentials with odd or indefinite symmetry, however, don’t have to have solutions of definite parity at all (and odd potentials can’t have bound states!)\n\n<!-- \\emph{Parity only has two eigenvalues,\n$P = \\pm 1$}: degenerate, with e.g.~$\\hat{H}$ breaking the degeneracy of\n$\\sin$ \\& $\\cos$ solutions with its tower of $E_n$ eigenvalues\n-->\n\n:::{.callout-caution}\n\nThe goodness of the parity quantum number is directly related to the definite parity of the potential, $U(x) = U(-x)$. __An asymmetric potential,\n$U(x) \\neq U(-x)$, will not have eigenstates of definite parity.__\n\nThis is why earlier we justified this choice for defining the potential in the interval $[-a,a]$ instead of $[0,L]$.\n\nYou need to be careful about coordinates: a well in $[0 \\ldots L]$ has only \"sine\" solutions, and $-x$ is no longer useful, but the\nreal symmetry is still there. Parity is defined about a coordinate origin: you need to choose an appropriate one.\n\n:::\n\n\n## The delta-function potential\n\n_What happens if we make the infinite well potential infinitely narrow, i.e. for $L\\to 0$?_\n\nWe obtain a delta well potential!\n\nThe infinite square well showed us a system where the wavefunction is non-trivial only in the classically allowed region with $E > U$, and we saw that it was a wave-like sinusoid in that region.\n\nLet's change the \"reference\" zero potential (without loss of generality) so that $U=0$ everywhere except at $x = 0$ where we place a _negative_ delta-function well $U(x)=C- \\alpha \\delta(x)$. Without loss of generality, we can set $C=0$, so\n\n$$\nU(x) = \n\\begin{cases}\n- \\alpha \\delta(x) \\quad \\mathrm{at} ~x=0\\\\\n0 \\quad \\mathrm{otherwise},\n\\end{cases}\n$$\n\nwhere $\\alpha$ is a positive constant determining its \"strength\".\n\nThe delta-function potential is a neat way to show the behaviour of the complementary classically-disallowed region where $E < U$. We can then put both solution types together to build composite wavefunctions for potentials and with both allowed and finitely-disallowed regions in $x$.\n\nThe particle energy for a bound state has to be $E < 0$, so we expect to see it localised somewhere around the needle-like potential at $x=0$.\nBut there is no space for a non-trivial wavefunction within the well, and the particle kinetic energy is only the finite amount $E$ short of being enough to escape the well, so this time we find a non-trivial wavefunction _outside_ the well only.\n\nLet's solve the TISE. For $x\\neq 0$, $U(x)=0$, so the TISE is\n\n$$\n\\frac{d^2\\psi}{d{x}^2} = - \\frac{2mE}{\\hbar^2} \\psi \\equiv \\kappa^2 \\psi\n$${#eq-TISE-delta-function}\n\nfor $\\kappa = \\sqrt{-2mE}/\\hbar$.\n\n\n_Why did we define this constant?_\n\nThe same argument as for using plane wave solutions within the infinite well applies to the flat $U = 0$ potential, but this time with a relative minus sign on the “spare energy” $E − U$. \nWe are looking at bound states first, so $E<0$ and $\\kappa$ is real and positive.\nWere we to approach this naively to find the  solution, we could assume the usual $e^{ikx}$ form, compute that $k = \\sqrt{2mE}/\\hbar = i\\sqrt{2m|E|}/\\hbar$ , and let the $i$ factors cancel to turn the complex exponential into a real exponential $e^{\\pm |k|x}$; being a little smarter we can\nanticipate this already and instead define the exponential constant as $\\kappa = \\sqrt{2m|E|}/\\hbar$.\n\nFor real $\\kappa$, i.e. $E<0$, the general solution of @eq-TISE-delta-function is\n$$\n\\psi(x)=A_-e^{-\\kappa x}+B_-e^{\\kappa x},\n$$\n\nbut for $x\\leq 0$ the first term blows up, so $A_-=0$ for $x\\leq 0$ and\n$$\n\\psi(x)=B_-e^{\\kappa x}.\n$${#eq-sol-delta-xneg}\n\nVice versa, for $x\\geq 0$ the second term of the general solution must be $0$, so in that case we will have\n$$\n\\psi(x)=A_+e^{-\\kappa x}+B_+e^{\\kappa x},\n$$\n\nwith $B_+=0$, so for $x\\geq 0$\n\n$$\n\\psi(x)=A_+e^{-\\kappa x}.\n$${#eq-sol-delta-xpos}\n\nNow we need to impose the _standard boundary conditions_:\n\n1. $\\psi$ must be _continuous_\n2. $d\\psi/dx$ must be continuous except at points at infinite potential\n\n_Continuity:_\n\nEquating @eq-sol-delta-xneg and @eq-sol-delta-xpos at $x=0$:\n$\\psi(0)=B_-=A_+\\equiv A$, so\n\n$$\n\\psi(\\pm |x|)=Ae^{-\\kappa |x|}.\n$$\n\nThe delta-function potential and the obtained solutions are represented in @fig-delta-function-pot.\n\n![Delta-function potential and allowed solutions.](img/delta-potential.png){#fig-delta-function-pot}\n\n\nFor point 2 of the boundary conditions, the derivative of the wavefunction would be discontinuous at $x=0$ due to the delta potential (infinite potential). To impose the continuity of the derivative everywhere else, integrate SE around 0, i.e. in an infinitesimal interval $[−\\epsilon,\\epsilon]$ and then take the limit $\\epsilon \\to 0$, obtaining a single allowed value of $\\kappa=\\frac{m\\alpha}{\\hbar^2}$.\n\nWe can find $A$ by imposing the normalization condition with the mod-square as usual, and find\n\n$$\nA = \\sqrt{\\kappa} = \\frac{\\sqrt{m\\alpha}}{\\hbar},\n$$\n\nso the delta-function well, regardless of the strength $\\alpha$, has exactly _one (discrete) bound state_ given by the following wavefunction and eigenvalue:\n\n$$\n\\psi(x)=\\frac{\\sqrt{m\\alpha}}{\\hbar}e^{-m\\alpha |x|/\\hbar^2}; \\quad E=-\\frac{m\\alpha^2}{2\\hbar^2}.\n$${#eq-delta-func-sol}\n\nDemonstrate this as an exercise!\n\n::: {.callout-note}\n\n- The wavefunction has _tails_ even outside the \"well\", where we would not expect to find the particle. This is the _tunneling effect_.\n\n- Note that there is _no quantization_ of the allowed values for $\\kappa$, and therefore for $E$: any given $E$ has a valid stationary solution (valid for any $\\alpha$).\n:::\n\nThe typical length $\\sim 1/\\kappa$ to which the decaying exponentials “escape” the delta-function increases the smaller the energy deficit $|V − E|$ for escaping the well: $1/\\kappa = \\hbar/\\sqrt{2m|E|}$. A finitely deep potential would break this continuous spectrum of energy eigenvalues by re-enabling the differentiability boundary condition... but of course there is no way to be both finitely deep and infinitely thin! Our next stop will, however, have aspects of both extreme solutions.\n\n\n## The finite square well\n\nLet's now imagine to start with the infinite well potential, but now lower the potential walls to a finite potential $U_0$ which will represent the depth of the well.\n\nThe finite square well is a well of both finite width and depth, from which both the infinite-square and delta-function wells are asymptotic limits. As its potential’s geometry is still composed of piecewise-assembled flat elements, it is the simplest case where we get to synthesise the distinct oscillatory and evanescent solution types (i.e. complex and decaying exponentials) together.\n\nThe potential is given by the function\n\n$$\nU(x)=\n\\begin{cases}\n-U_0 \\quad \\mathrm{for} ~-a\\leq x\\leq a,\\\\\n0 \\quad \\mathrm{for} ~|x|>a,\n\\end{cases}\n$$\n\nwhere $U_0$ is a positive constant.\n\n![Square well potential. Here the potential is indicated as $V(x)$ instead of $U(x)$.](img/square_well.png){#fig-square-well-pot}\n\nThe bound states will be found for $E<0$, inside the well, where the general solution is oscillatory. Outside the well, for $E>0$, the solution will be exponentially decaying and we have scattering states.\n\n### Bound states\n\nLet's look at the bound states ($E<0$).\n\nOutside the well, in the region $x<-a$, the potential is 0, therefore the TISE can be rearranged in the form\n\n$$\n\\frac{d^2\\psi}{dx^2}=\\kappa^2\\psi,\n$${#eq-TISE-square-well-outside}\n\nwhere $\\kappa\\equiv \\sqrt{-2mE}/\\hbar = \\sqrt{2m|E|}/\\hbar$ (real and positive).\n\nSimilarly to the case of the delta function, the general solution for this is $\\psi(x)=A_-e^{\\kappa x}+B_-e^{-\\kappa x}$, but the second term would blow up for $x\\to -\\infty$, so just like for the delta-function:\n\n$$\n\\psi(x)=A_-e^{\\kappa x} \\quad \\mathrm{for} ~x<-a.\n$${#eq-sq-well-sol-xless-a}\n\nDue to the symmetry of the potential well, defined in the interval $[-a,a]$, we can find the solutions knowing that they have definite parity. It would in principle be sufficient to find the solutions for either positive or negative values of $x$ and then use the parity condition.\n\nFor $x>a$, using the parity operator or following the same argument also seen for the previous case of the delta potential, the solution is\n\n$$\n\\psi(x)=A_+e^{-\\kappa x}\\quad \\mathrm{for} ~x>a.\n$$\n\nThe coefficients B and F are determined by matching this wave smoothly by imposing the continuity conditions of the wavefunction and its derivative in space, inside the well.\n\nThe fact that $\\psi(x)$ is nonzero at the walls increases the de Broglie wavelength in the well with respect to the case of a particle in the infinite well potential, and this lowers the energy and momentum of the particle (increasing $\\Delta x \\implies$ decreasing $\\Delta p$).\n\nInside the well the energy $E$ can't be lower than $-U_0$, so the energy must satisfy the condition $-U_0\\leq E <0$, and the TISE for $|x|<a$ is\n\n$$\n\\frac{d^2\\psi}{dx^2}+\\lambda^2\\psi=0,\n$${#eq-TISE-square-well-inside}\n\nwhere $\\lambda = \\sqrt{2m(U_0+E)}/\\hbar = \\sqrt{2m(U_0-|E|)}/\\hbar$ and $|E|=-E$ is the _binding energy_ of the particle.\n\n\nThe solutions to @eq-TISE-square-well-inside include both even and odd oscillatory functions:\n\n$$\n\\psi(x)=B\\cos(\\lambda x)+C\\sin(\\lambda x) \\quad \\mathrm{for} ~|x|>a\n$$\n\nPutting these together, the solution for bound states, with $E<0$, is\n\n$$\n\\psi(x)=\n\\begin{cases}\nA_- e^{\\kappa x} \\quad \\mathrm{for} ~x<-a,\\\\\nB\\cos(\\lambda x)+C\\sin(\\lambda x) \\quad \\mathrm{for} ~|x|>a,\\\\\nA_+ e^{-\\kappa x} \\quad \\mathrm{for} ~x>a.\n\\end{cases}\n$$\n\nWe can use the symmetry however to find that $A_-=A_+\\equiv A$ because of the definite parity. This also implies that either $B=0$ or $C=0$.\n\nWe need to impose the BCs to find the coefficients, and specifically we need to impose the continuity of $\\psi$ and of $d\\psi/dx$.\n\n_Continuity:_\n\n- Even function:\n\n$$\nB\\cos(\\lambda a)=Ae^{-\\kappa a}; \\quad -\\lambda B\\sin(\\lambda a)=-\\kappa A e^{-\\kappa a},\n$$\n\nand dividing the second equation above by the first:\n\n$$\n\\tan(\\lambda a)=\\kappa/\\lambda.\n$${#eq-square-well-BC-cont-even}\n\n- Odd function:\n\n$$\nC\\sin(\\lambda a)=Ae^{-\\kappa a}; \\quad \\lambda C\\cos(\\lambda a)=-\\kappa A e^{-\\kappa a},\n$$\n\nand again dividing the two equations:\n\n$$\n-\\cot(\\lambda a)=\\kappa/\\lambda.\n$${#eq-square-well-BC-cont-odd}\n\nThe energy levels are found by solving the _trascendental equations_ @eq-square-well-BC-cont-even and @eq-square-well-BC-cont-odd, either numerically or graphically, cause we can't solve these analytically unfortunately.\n\nIt helps to visualise these functions and find graphically the solutions, corresponding to the points at the intersections of $f(\\lambda) = \\kappa/\\lambda$ with the even and odd transcendental functions $g_\\pm(\\lambda) = \\{\\cos,\\sin\\}(\\lambda a)$, as in @fig-square-well-eigenval-sols.\n\n![Graphic representation of functions in @eq-square-well-BC-cont-even and @eq-square-well-BC-cont-odd obtained imposing the BCs. The intersections between both $-\\cot(\\lambda a)$ and $\\tan(\\lambda a)$ with $\\kappa/\\lambda$ represent the solutions.](img/squarewell-fin-solns.png){#fig-square-well-eigenval-sols}\n\nAs expected for bound states, we obtain a set of _discrete_ eigenvalues given by the quantum numbers in @fig-square-well-eigenval-sols, with __alternating even and odd__ eigenfunctions - even for $n=1,3,...$ and odd for $n=2,4,...$.\n\nThe spacing between the intersections is also increasing with $n$, just like in the infinite well potential, so _the eigenvalues are not equally spaced_.\n\nIt is also worth noting that in contrast with the infinite well potential, here we have a __finite number of eigenvalues__ (e.g. 6 states represented in @fig-square-well-eigenval-sols or 3 represented in @fig-square-well-eigenstates), but how many we have in general will depend on the strength of the potential.\nThis is in contrast with the case of the infinite well potential where we had infinite discrete energy levels.\nIn fact, there will be a finite $n$ for which $E>0$ and the state is no longer bound.\n\n\n_How does the number of eigenvalues change when we change the depth of the potential or the width?_\n\n\nYou can normalize the wavefunction to find the values of the coefficients, but I will skip this here and consider instead what happens in two limit cases, where we make the well way deeper or where we make it very narrow.\n\n:::{.callout-note}\n\nNote that we could have defined the square well potential with a _different zero of the energy_, having zero potential inside the well and a finite potential $U_0$ outside the well. The procedure and the eigenfunctions found are exactly the same, what would change in that case would be the energies in $\\lambda$ and $\\kappa$ to account for a shift of $U_0$, i.e. we would have $\\lambda=\\sqrt{2mE}/\\hbar$ and $\\kappa=\\sqrt{-2m(E-U_0)}/\\hbar$.\n\n:::\n\n![Finite square well potential and corresponding eigenvalues and eigenstates (3 possible states in  this case).](img/squarewell-fin-solns3.png){#fig-square-well-eigenstates}\n\n#### Deep well limit\n\nWith the above consideration, let's conveniently shift the square well \"up\" so its outer walls are at a finite potential of $U_0$ and the inside of the well has zero potential.\nThis is convenient just because earlier we considered this convention in the infinite well potential, and in fact if we keep increasing the potential $U_0$, in the limit $U_0\\to \\infty$, the infinite well potential is exactly what we should obtain. \n\nSo let's see what happens if we increase $U_0$: $\\kappa$ will increase too with it, and will push the curve $f(\\lambda)$ upward uniformly, with two effects:\n\n- increase in the number of eigenvalues (intersections with the $g_\\pm(\\lambda)$ functions)\n- the intersections move towards the asymptotic limits of the functions $g_\\pm(\\lambda)$ (see straight lines in @fig-square-well-eigenval-sols), i.e. $\\lambda a = (n + 1/2)\\pi$ or $n\\pi$ for the even and odd solutions respectively: you can verify that these correspond — as they should — to the half-wavelength solutions of the infinite square well.\n\n\nFurthermore, the divergence of the $f(\\lambda)$ function for small $\\lambda$, while the $g_+(\\lambda)=\\tan(\\lambda a)$ function heads to zero, means there is always guaranteed to be at least one bound state, of $\\cos$-type. The solutions hence have the same main features as seen in the infinite well: an even-symmetric ground state, excited states alternating in parity, and in the large-$\\lambda$ limit where $f(\\lambda)$ is nearly flat, quadratically increasing state energy $E = (\\hbar\\lambda)^2/2m$.\n\n#### Narrow potential limit\n\nIn the limit of infinitely narrow potential, i.e. $a\\to 0$, we have the delta-function potential seen in the previous section.\n\nThe decaying exponentials in the walls also exhibit the delta-potential feature that they penetrate further for high-energy states, eventually achieving boundless range as $U_0 − E \\to 0$, i.e. to freedom.\n\n<!-- \nIt helps to define\n$$\na^2\\kappa^2 + a^2\\lambda^2 = \\frac{2m U_0a^2}{\\hbar^2} \\equiv \\gamma^2,\n$${#eq-square-well-parameter-strength}\n\nwhere we used the definitions of $\\kappa$ and $\\lambda$, and where $\\gamma$ here is a dimensionless \"strength parameter\", dependent both on the depth and the width of the potential.\n\nYou can notice that @eq-square-well-parameter-strength is the equation of a circle of radius $\\gamma$, with coordinates $y=a\\kappa$ and $x=a\\lambda$.\n\nNote $\\kappa/\\lambda = \\sqrt{|E|/(U_0-|E|)}:$ the lower $U_0$ is, -->\n\n## The harmonic well potential (quantum harmonic oscillator)\n\nMany potentials could be approximated as harmonic oscillators by doing a Taylor expantion to the second order, around a minimum of the potentials.\nQuantum harmonic oscillators (QHO) are _extremely_ useful in physics, and real vibrations can be indeed described with harmonic approximations.\n\nThe form of the potential for the harmonic oscillator is\n\n$$\nU(x)=\\frac{1}{2}Kx^2 = \\frac{1}{2}m\\omega^2 x^2,\n$${#eq-QHO-potential}\n\ntherefore the Hamiltonian and the corresponding TISE are, respectively:\n\n$$\n\\hat{H}=[\\hat{p}^2+(m\\omega\\hat{x})^2]/2m,\n$${#eq-QHO-Hamilt}\n\n$$\n-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi}{dx^2}+\\frac{1}{2}m\\omega^2 x^2\\psi=E\\psi.\n$${#eq-QHO-TISE}\n\nSolving this TISE with a differential equation approach in the wave formalism is a bit of a nightmare and I do not expect you to do it, not using this method at least!\nWe can take a guess and see that due to the symmetry of the system we would expect a ground state that is symmetric around the centre of the potential and has no nodes. The simplest form for this would be a Gaussian, and in fact the ground state of the QHO is given by @eq-QHO-ground-state-x, and the eigenfunctions, with $n=0,1,2,...$ are in general given by @eq-QHO-eigenfunctions-x, while the eigenvalues are @eq-QHO-eigenvalues.\n\n\n:::{.callout-note icon=\"false\"}\n\n## Eigenvalues for the QHO\n$$\nE_n = (n + \\tfrac{1}{2}) \\hbar \\omega\n$${#eq-QHO-eigenvalues}\n\n- Note that the ground state energy is not zero! As for other bound states, we have a _zero-point_. For the QHO this is $E_0=\\frac{\\hbar\\omega}{2}$.\n\n- Note that the eigenvalues are all equally spaced in the QHO, in contrast with the well potentials encountered so far. The energy spacing between consecutive energy levels is $\\hbar\\omega$.\n\n:::\n\nThis also seems an apt point to mention a general feature of all the bound-state wavefunctions we have studied: their ground state — $n = 1$ for the infinite well, $n = 0$ for the quantum (simple) harmonic oscillator (QHO) — always has a finite __zero-point energy__ $E_{ground} > 0$.\n\nThe zero-point energy comes from the Heisenberg's uncertainty principle. \nIn this case, imagine that your particle is exactly at the bottom of the well, so that the potential energy is 0. What would the implication be? If the position is very well defined, then the momentum must have a larger uncertainty, meaning that the kinetic energy would be higher and therefore the particle could not be _still_ at the bottom of the harmonic potential! There is always going to be some energy even at the lowest possible state. \n\n:::{.callout-note icon=\"false\"}\n\n## Ground state and eigenfunctions of the QHO\n\nThe ground state of the QHO is the Gaussian\n$$\n\\psi_0(x) = \\left( \\frac{m \\omega}{\\pi \\hbar} \\right)^{1/4} \\exp\\left\\{- \\frac{m \\omega}{2 \\hbar} x^2 \\right\\},\n$${#eq-QHO-ground-state-x}\n\nand the $n$-th excited state has the following eigenfunctions, built from the Hermite polynomials $H_n(\\xi)$, where $\\xi=\\sqrt{m\\omega/\\hbar}x$,\n\n$$\n\\psi_n(x) = \\left(\\frac{m \\omega}{\\pi \\hbar}\\right)^{1/4} \\frac{1}{\\sqrt{2^n n!}} H_n(\\xi) e^{-\\xi^2/2}.\n$${#eq-QHO-eigenfunctions-x}\n\nThe Hermite polynomials are defined by repeated differentiation of a Gaussian:\n\n$$\nH_n(x)=(-1)^ne^{x^2}\\frac{d^n}{dx^n}e^{-x^2}.\n$${#eq-hermite-polyn}\n\n:::\n\nThe Hermite polynomials alternate in parity and add more nodes to the wavefunction with every increment of $n$.\n\nIt’s neat to note how this works, since usually differentiation is thought of as reducing polynomial orders, but here it seems to increase them. The trick is in the Gaussian and the product rule: each time a derivative is taken, the Gaussian term produces a new multiplying factor of $−2x$, and hence raises the highest polynomial power by one. At the same time, the product rule requires that any already-existing polynomial terms\nbe separately differentiated, which reduces their powers by one.\nThe pre-multiplying inverse-Gaussian in @eq-hermite-polyn is just there to remove the differentiation/multiplication-resilient Gaussian term; we then multiply the square-root of this back into place for our QHO solution.\n\nThe Hermite polynomials represent a \"classic\" orthogonal set, just like the Fourier terms that we have encountered in the finite square well.\nAnother orthogonal set is given by the Legendre functions, which we will encounter when we deal with the angular momentum.\n\nThe eigenvalues and eigenfunctions are shown in @fig-QHO-solutions.\n\n![Eigenvalues and eigenstates (shifted to the levels of eigenvalues) of the QHO.](img/sho-psi1-5-orig.jpg){#fig-QHO-solutions}\n\nThis is a good point to introduce the _matrix formalism_, i.e. the _bra-ket notation_, or _Dirac notation_ that we mentioned at the beginning of the course, and solve the Schrödinger equation (@eq-QHO-TISE) using this.\nThis formalism is also way more convenient to solve problems and exercises on the QHO (unless you really like doing integrals...), as we will see in an example at the end of the chapter.\nIt'll also be very useful to deal with angular momentum later on!\n\nI will skip all the formalism to start with, and we'll get to it in the following chapter.\n\nLet's just build some useful rules with a new notation.\n\n### An introduction to the Dirac notation\n\nLet's say that instead of using the notation $\\psi_n(x)$ to describe the eigenfunctions (using the wave formalism), we replace these with the notation $|n\\rangle$, where these are now vectors (called _kets_) indicating the states of @eq-QHO-eigenfunctions-x. Physically, we are not changing anything, only the way we decide to formalise them mathematically.\n\nSo now we have the ground state $|0\\rangle$ and the excited states $|1\\rangle, ~|2\\rangle, ~...$ with energies given by @eq-QHO-eigenvalues.\n\nLet's call these _number states_.\n\nThe Hermitian conjugate of a state $|n\\rangle$ is described by another vector (called _bra_) with the notation $\\langle n|$, such that $\\langle n|\\equiv|n\\rangle^{\\dagger}$.\n\nWe can go up and down these states by providing or removing energy in multiples of $\\hbar\\omega$. We have like a \"ladder\" of states, equally spaced (see @fig-ladder-QHO).\n\nHow about we introduce some operators to move across this ladder of states?\nEnter the _ladder operators_! These are obtained from linear combinations of $\\hat{x}$ and $\\hat{p}$, as follows.\n\n:::{.callout-important}\n\n## Ladder operators\n\nThe _ladder operators_ are defined as:\n$$\n\\hat{a}_{\\pm}\\equiv \\frac{1}{\\sqrt{2\\hbar m\\omega}}(m\\omega\\hat{x}\\mp i\\hat{p}).\n$${#eq-ladder-ops}\n\nThe position and momentum operator, in terms of the ladder operators, can be written as\n\n$$\n\\hat{x} = \\sqrt{\\frac{\\hbar}{2m\\omega}}(\\hat{a}_++\\hat{a}_-); \\quad \\hat{p}=i\\sqrt{\\frac{\\hbar m\\omega}{2}}(\\hat{a}_+-\\hat{a}_-).\n$${#eq-pos-mom-op-ladders-op}\n\n- Note that $\\hat{a}_-^{\\dagger}=\\hat{a}_+$.\n- The ladder operators do not commute: $[\\hat{a}_-,\\hat{a}_+]=1$.\n- The ladder operators are __not observables__ so they are not Hermitian operators and do not correspond to any physical measurable quantity.\n\n- Given a solution of the SE with energy $E$, application of $\\hat{a}_\\pm$ return a solution with energy $E\\pm \\hbar\\omega$, i.e. bring the state one level up or one down! However, since the lowest state is $|0\\rangle$, $\\hat{a}_-|0\\rangle=0$.\n\nIn general:\n$$\n\\hat{a}_-|n\\rangle=\\sqrt{n}|n-1\\rangle; \\quad \\hat{a}_+|n\\rangle=\\sqrt{n+1}|n+1\\rangle \\\\\n$${#eq-ladder-ops-states}\n\n:::\n\n:::{.callout-caution}\n\nBe careful when applying the operators on the bras!\nYou need to consider the conjugate of both operator and state vector, so:\n\n$$\n\\langle n|\\hat{a}_- = (\\hat{a}_+|n\\rangle)^{\\dagger} = \\sqrt{n+1}\\langle n+1|; \\quad \n\\langle n|\\hat{a}_+ = (\\hat{a}_-|n\\rangle)^{\\dagger} = \\sqrt{n}\\langle n-1|. \n$${#eq-ladder-ops-states-conjugates}\n\n:::\n\n![Graphic representation of the \"ladder\" of states of the QHO.](img/ladder_ops.png){#fig-ladder-QHO width=50%}\n\nUsing the ladder operators, the Hamiltonian of the QHO (@eq-QHO-Hamilt) can be rewritten as\n$$\n\\hat{H}=\\hbar\\omega(\\hat{a}_+\\hat{a}_-+\\tfrac{1}{2}), \\quad \\hat{H}=\\hbar\\omega(\\hat{a}_-\\hat{a}_+-\\tfrac{1}{2})\n$${#eq-QHO-Hamilt-ladder-ops}\n\nIt is therefore convenient to define the _number operator_ $\\hat{n}$.\n\n:::{.callout-note}\n\n## Number operator and number states\n\nThe number operator\n$$\n\\hat{n}=\\hat{a}_+\\hat{a}_-\n$${#eq-number-op}\n\nreturns the _principal quantum number_ $n$:\n\n$$\n\\hat{n}|n\\rangle=n|n\\rangle.\n$${#eq-number-op-states}\n\nThis is an eigenvalue equation, and the number states $|n\\rangle$ constitute a _complete orthonormal basis_:\n\n$$\n\\langle n|m\\rangle =\\delta_{nm}.\n$$\n\n:::\n\n#### <span style=\"color:#336699;\">Exercise</span>\n\nShow @eq-QHO-Hamilt-ladder-ops starting from @eq-QHO-Hamilt.\n\n<details>\n<summary>Solution</summary>\n\nUsing @eq-ladder-ops:\n$$\n\\begin{aligned}\n\\hat{a}_- \\hat{a}_+\n    &= \\frac{1}{2\\hbar m \\omega} (i \\hat{p} + m \\omega \\hat{x}) (-i \\hat{p} + m \\omega \\hat{x})\\\\\n    &= \\frac{1}{2\\hbar m \\omega} \\left(\\hat{p^2} + (m \\omega \\hat{x})^2 -i m \\omega [\\hat{x}, \\hat{p}] \\right)\\\\\n    &= \\frac{1}{2\\hbar m \\omega} \\left[\\hat{p^2} + (m \\omega \\hat{x})^2\\right] + \\frac{1}{2}\\\\\n    &= \\frac{1}{\\hbar \\omega} \\hat{H} + \\tfrac{1}{2}\n\\end{aligned}\n$$\n\nRearranging this: $\\hat{H} = \\hbar \\omega \\left( \\hat{a}_- \\hat{a}_+ - \\tfrac{1}{2} \\right)$.\n\nSimilarly\n\n$$\n\\hat{a}_+ \\hat{a}_-= \\frac{1}{\\hbar \\omega} \\hat{H} - \\tfrac{1}{2} \\implies \\hat{H} = \\hbar \\omega \\left( \\hat{a}_+ \\hat{a}_- + \\tfrac{1}{2} \\right).\n$$\n\n</details>\n\n### Solving the harmonic oscillator\n\n\n#### Ground state\n\nWe can find the ground state explicitly, knowing that $\\hat{a}_-|0\\rangle =0$ and using the definition of $\\hat{a}$ in terms of $\\hat{p}$ and $\\hat{x}$ from @eq-ladder-ops.\n\nMoving back to the waves formalism:\n\n$$\n\\hat{a}_-\\psi_0 \\propto (i\\hat{p}_m\\omega\\hat{x})\\psi_0=0\\implies \\frac{d\\psi_0}{dx}=-\\frac{m\\omega}{\\hbar}x\\psi_0.\n$$\n\nThis has solution\n\n$$\n\\psi_0(x) = \\left( \\frac{m \\omega}{\\pi \\hbar} \\right)^{1/4} \\exp\\left\\{- \\frac{m \\omega}{2 \\hbar} x^2 \\right\\},\n$$\n\nwhich is a _normalised Gaussian_.\n\nWe can verify the ground state energy from $\\hat{H}\\psi_0$ with the Hamiltonian of @eq-QHO-Hamilt-ladder-ops, using $\\hat{a}_-\\psi=0$: \n$$\n\\hbar\\omega(\\hat{a}_+\\hat{a}_-+\\tfrac{1}{2})\\psi_0=E_0\\psi_0=\\hbar\\omega/2.\n$${#eq-QHO-E0-deriv}\n\n#### Excited states eigenenergies\n\nIn general, if we apply @eq-QHO-Hamilt-ladder-ops to the state $|n\\rangle$, we find\n\n$$\n\\hbar\\omega(\\hat{n}+\\tfrac{1}{2})|n\\rangle=\\hbar\\omega(n+\\tfrac{1}{2})|n \\rangle = E_n |n\\rangle \\implies E_n = \\hbar\\omega(n+\\tfrac{1}{2}).\n$${#eq-QHO-En-deriv}\n\n#### Expectation values calculations\n\nTypical exercises with QHO and other potentials in general require to calculate expectation values of various operators, e.g. of position, momentum, etc, on eigenstates or combinations thereof.\n\nWe saw that in the waves formalism the expectation value of an operator $\\hat{A}$ on a state $\\psi_n(x)$ is\n\n$$\n\\langle \\hat{A} \\rangle = \\int \\psi_n^*(x)\\hat{A} \\psi_n(x) dx.\n$${#eq-exp-val-wavefunctions}\n\nHow do we calculate the equivalent with the Dirac notation? We use the Hermitian conjugate of the _ket_ $|n \\rangle$, called a _bra_, $\\langle n|\\equiv|n\\rangle ^{\\dagger}$.\n\nSo when we want to calculate an expectation value, we still have a sandwich in the _bra-ket_ (now you know why they have these names), as follows:\n\n$$\n\\langle \\hat{A} \\rangle = \\langle n | \\hat{A} | n\\rangle.\n$${#eq-exp-val-states-n}\n\nLet's consider a typical example with the QHO, both with the wave notation and the Dirac notation.\n\nAt the end of the chapter we'll see more on the Dirac notation.\n\n#### <span style=\"color:#336699;\">Exercise</span>\n\nCalculate $\\langle \\hat{p}\\rangle$ on the ground state of the QHO, using two methods:\n\n1. Using $\\psi_0$ as in @eq-QHO-ground-state-x and the wave formalism\n2. Using the Dirac notation with the state $|0\\rangle$.\n\n<details>\n<summary>Solution</summary>\n\n1. Let's use @eq-QHO-ground-state-x and the formula for the expectation values @eq-exp-val-wavefunctions, with $\\hat{p}=-i\\hbar \\tfrac{d}{dx}$:\n\n$$\n\\begin{aligned}\n\\langle \\hat{p} \\rangle &= \\int_{-\\infty}^{\\infty} dx \\psi_0^*\\hat{p}\\psi_0\\\\\n&=\\sqrt{\\frac{m\\omega}{\\pi\\hbar}}\\int_{-\\infty}^{\\infty} dx i\\hbar\\frac{m\\omega}{\\hbar}x\\exp\\left\\{-\\frac{m\\omega}{\\hbar}x^2\\right\\}=0\n\\end{aligned},\n$$\n\nwhere we can say that it is $0$ because of the parity of the function: it is odd, so the integrals in the positive and negative coordinates cancel each other.\n\nThis method requires more familiarity with evaluation of derivatives and integrals. Let's look at the second method.\n\n2. Let's use $\\hat{p}$ as defined in @eq-pos-mom-op-ladders-op, evaluated on the state $|0\\rangle$:\n\n$$\n\\begin{aligned}\n\\langle \\hat{p}\\rangle &\\propto \\langle 0 |(\\hat{a}_+-\\hat{a}_-)|0\\rangle = \\langle 0|\\hat{a}_+|0\\rangle - \\langle 0|\\hat{a}_- |0 \\rangle\\\\\n&\\propto \\langle 1|0\\rangle -0=0.\n\\end{aligned}\n$$\n\nThis method requires to know (check formula sheet) how the ladder operators act on number states, and to use the fact that these are orthonormal. Easy peasy!\n\n</details>\n\n## Rules for wavefunctions in general potentials\n\nThe nature of QM is that once we go beyond these simple potentials it rapidly becomes impossible to calculate analytic solutions: we already saw this for even a case as simple as the finite square well. It’s a nice example of Rutherford’s comment that “All of physics is either impossible or trivial.”. Rutherford went on to say that “It is impossible until you understand it, and then it becomes trivial,”, so in that spirit this section is dedicated to showing you that even if a solution cannot be calculated in the nice closed form we’re used to, and we have to resort to numerical computation instead if we want accurate numbers, it is very possible — trivial, Rutherford would say — to understand why they look the way they do.\n\n\nThe arguments we will use are based on out existing set of boundary and integrability conditions, plus features given by the TISE (@eq-TISE):\n\n1. A stationary wavefunction $\\psi(x)$ must always be continuous, i.e. no sudden jumps in amplitude across differentially small distances dx.\n\n2. It must also be differentiable, i.e. smooth, except at infinite-sized potential steps: for those a kink is permitted.\n\n3. All wavefunctions must go to zero at infinite distance, for integrability: as bound states are defined to have $E < V$ at infinity, this means that the wavefunction must go to zero in classically forbidden regions.\n\n4. Any general potential can be built by concatenating flat-potential wavefunctions for each flat region, and matching them via the boundary conditions. You can think of general potentials as a stack of thin square potentials: same rules apply, i.e. continuous and smooth wavefunctions. _Every wavefunction is locally a real or complex exponential, connected to the next piece via BCs._\n\nThis is the essence of the __WKB approximation__ technique - but for sketching purposes you can imagine a roughly equivalent piecewise-flat potential and fudge the smoothing of the steps.\n\n5. The TISE can be written in the form: $\\frac{d^2\\psi}{dx^2} \\Big/ \\psi = - \\frac{2m}{\\hbar^2}(E-U) \\implies$ curvature is toward the $x$-axis, i.e. toward $\\psi=0$, in classically allowed regions $E-U>0$, away from it in forbidden ones, i.e. away from the $\\psi=0$ axis in disallowed regions.\n\nFor a fixed $E-U$, the degree of curvature is proportional to the value of $\\psi$: a large amplitude will be highly curved, e.g. the curvature of the cos function has its maximum value where the cosine is largest.\n\n6. The wavefunction is oscillatory where net positive kinetic energy $E - U$; evanescent/exponential where negative.\n\nIn a region of $x$ with a flat potential, $U(x) =$ const, the solution will be wavelike and oscillatory if $E > U$, i.e. it is classically allowed, and an exponential in classically forbidden regions with $E < U$. Rule 3 forces these exponentials to decay at the edges of the potential toward $\\pm\\infty$.\n\n7. The typical inverse scale of both the oscillating and decaying solutions — respectively the wavenumber and the decay constant — becomes larger as the magnitude of excess or deficient energy with respect to the potential increases.\n\n_Curvature/frequency scale with energy difference_: $-\\frac{\\hbar^2}{2m} \\frac{d^2{\\psi}}dx^2 \\to \\frac{\\hbar^2 k^2}{2m}= (E-U)$, with $\\sim 1/k$ as more kinetic energy $E − U$ in allowed regions leads to larger wavenumbers and hence smaller wavelengths; a greater energy deficit $U − E$ in forbidden regions gives a more rapidly decaying exponential.\n\n8. _Amplitude is smaller where KE is larger (more velocity, less likely to be found there)_\nCounterintuitively, in allowed regions the envelope of the wavefunction will be smaller where the kinetic energy $E − U$ is larger: intuitively, where the particle has more velocity, it spends less of its time and is less likely to be found.\n\n\n9. _Principal quantum number_ $n = 1,\\dots \\implies n$ _bumps or_ $n-1$ nodes._\nSolutions always come in a perhaps finite stack indexed by the _principle quantum number_ $n$. The ground state, with lowest $n$, always has zero nodes ($\\psi = 0$ points); each higher state adds one node. Alternatively, the ground state only has one\n“bump”; the higher states add a bump for each unit increase in $n$.\n\n10. _Remember definite parity for symmetric potentials._\n\nIf the potential has even symmetry, the stationary solutions will have definite parity, i.e. they will be exactly odd or even functions. If the potential doesn’t have even symmetry, the definite-energy wavefunctions will generally be asymmetric.\n\n\nWith these rules in hand, you should be able to render an acceptable guess of how the nth energy level of stationary wavefunction should look in any potential: some examples are given in @fig-sketch1-pot and @fig-sketch2-pot.\n\n\nBelow is (embedded) a document that goes more in detail and can be useful for sketching wavefunctions. A summary is reported below anyway.\n(If you are reading this from a non-html format, you can find the file on Moodle or at [this link](https://studylib.net/doc/25446030/wavefunctions).)\n\n![Rules for sketching wavefunctions. Unsure who the author of this is.](pdfs/sketching-wavefunctions.pdf){width=640px height=480px}\n\n### Examples of general potentials\n\n![Example of wavefunction associated to a potential. The turning points mark the limit between oscillatory and exponential solutions. In the oscillatory part, the amplitude is larger and the frequency smaller where the KE is smaller (left side).](img/wavefunction-sketch.png){#fig-sketch1-pot}\n\n![Example of a \"linear\" potential and associated wavefunction.](img/linearwell-solution7.png){#fig-sketch2-pot}\n\n### Periodic boundary conditions\n\nIn some cases, for instance for particles in a ring, it is possible to not have _any_ boundary conditions that fix wavefunction value at a certain place.\n\nIn such cases require equal value and derivative in $\\varphi \\to \\varphi + 2\\pi$ round the ring.\n\nFor a flat $V(\\varphi)$, the solution is a plane wave $\\psi(\\varphi)\\sim e^{im\\varphi}=e^{im(\\varphi+2\\pi)}$.\n\nRequire $e^{2\\pi im} = 1 \\implies$ integer $m$. This means that we must fit the whole wavelengths around the ring (as in @fig-particle-ring), and this is what we have seen for the Bohr atom and what we will see for the spherical harmonics.\n\n_The BC is now geometry rather than potential._\n\n![Example of a wavefunction in a periodic (ring) potential.](img/particle-ring-bc.png){#fig-particle-ring width=50%}\n\n## More on the Dirac notation\n\nAt the beginning of the course we saw that there are two equivalent formalisms to describe quantum mechanics: wave formalism and matrix formalism.\n\nUntil the QHO, we have used the former, which uses wavefunctions dependent on spatial coordinates (or coordinates in momentum space), and where operators are determined by functions acting on the wavefunctions.\n\nWith the matrix formalism however, we have states described by _row and column vectors_ (respectively \"bra\" and \"ket\") and operators described by _matrices_ acting on the states.\n\nIn the Dirac notation, every wavefunction can be written in the form of a __state vector__ $|\\Psi\\rangle$ in a given basis (e.g. position or momentum).\n\n\n### Bra, ket and operators\n\nKets are column vectors:\n\n$$\n|x\\rangle =\n\\begin{pmatrix}\nx_1\\\\ x_2\\\\ x_3 \\\\...\n\\end{pmatrix},\n$$\n\nwhere $x_i$ are the components of the vector.\n\nBras are row vectors and the Hermitian conjugate of ket-vectors (i.e. transpose the vector and take the complex conjugates of its elements):\n\n$$\n\\langle x|= (x_1^* ~~ x_2^* ~~ x_3^* ~~...) = |x\\rangle^{\\dagger}.\n$$\n\nThe dagger ($\\dagger$) indicates the Hermitian conjugate.\n\n\nOperators are represented by matrices, of the form\n\n$$\n\\hat{A} =\n\\begin{pmatrix}\nA_{11} & A_{12} & A_{13} & ...\\\\\nA_{21} & A_{22} & A_{23} & ...\\\\\nA_{31} & A_{32} & A_{33} & ...\\\\\n... & ... & ... & ...\n\\end{pmatrix}\n$$\n\nSo now you understand why earlier on we said that an operator $\\hat{A}^{\\dagger}$ is defined as the _conjugate transpose_ of $\\hat{A}$: you need to consider the complex conjugate and transpose the matrix.\n\n:::{.callout-note icon=\"false\"}\n\n## Eigenvalue equation with states \n\nThe __eigenvalue equation__ for an operator $\\hat{A}$ is\n\n$$\n\\hat{A}|\\phi_i\\rangle = a_i |\\phi_i\\rangle,\n$${#eq-eigenvalue-eq-dirac}\n\nwhere $a_i$ are the eigenvalues corresponding to the possible outcomes of the measurement, and $|\\phi_i\\rangle$ are the eigenstates.\n\n:::\n\n### Inner and outer product\n\nThe _inner product_ between ket and bra vectors returns a _scalar_ (i.e. a number):\n\n$$\n\\langle \\psi|\\phi\\rangle=(\\psi_1^* ~~ \\psi_2^* ~~ \\psi_3^* ~~ ...)\\begin{pmatrix}\n\\phi_1\\\\ \\phi_2\\\\ \\phi_3 \\\\...\n\\end{pmatrix} = \\sum_i \\psi_i \\phi_i^*\n$${#eq-inner-prod-dirac}\n\nThe _outer product_ gives a matrix:\n$$\n|\\psi\\rangle\\langle\\phi|=\\begin{pmatrix}\n\\psi_1\\\\ \\psi_2\\\\ \\psi_3 \\\\...\n\\end{pmatrix}(\\phi_1^* ~~ \\phi_2^* ~~ \\phi_3^* ~~ ...) =\n\\begin{pmatrix}\n\\psi_1\\phi_1^* & \\psi_1\\phi_2^* & \\psi_1\\phi_3^* & ...\\\\\n\\psi_2\\phi_1^* & \\psi_2\\phi_2^* & \\psi_2\\phi_3^* & ...\\\\\n\\psi_3\\phi_1^* & \\psi_3\\phi_2^* & \\psi_3\\phi_3^* & ...\\\\\n... & ... & ... &\\dots \n\\end{pmatrix}\n$${#eq-outer-prod-dirac}\n\n\n### Mapping to waves formalism\n\nWe can use these ingredients to see how we can go from waves to matrix formalism and viceversa.\n\n#### Eigenstates as a basis\n\nThe linear superposition of wavefunctions seen earlier can be applied also to the vector notation with kets or bras:\n$$\n|\\Psi\\rangle = \\sum_i c_i |\\phi_i\\rangle, \n$${#eq-state-sum-basis}\n\nwhere $\\{\\phi_i\\}$ are eigenstates of a Hermitian operator, forming a _complete, orthonormal basis_, and $c_i$ are the amplitudes.\n\n:::{.callout-note}\n\nA composite state no longer satisfies the eigenvalue equation @eq-eigenvalue-eq-dirac:\n\n$$\n\\begin{aligned}\n\\hat{A}|\\Psi\\rangle &= \\sum_i c_i \\hat{A}|\\phi_i\\rangle=\\sum c_i a_i|\\phi_i\\rangle\\\\\n&\\neq a \\sum_i c_i |\\phi_i\\rangle = a |\\Psi\\rangle.\n\\end{aligned}\n$$\n\nStates built from non-degenerate eigenstates do not have _definite quantum numbers!_\n\n:::\n\nWhen we consider a wavefunction $\\psi(x)$, this is defined in the position space, so we have to use the $x$ basis to write it. How do we give this information in the Dirac notation? We need to use the basis $\\{|{x}\\rangle\\}$, i.e. a set of quantum states, one for each $x$, satisfying the __identity operator__ in @eq-identity-complete-basis. The same could be done for the $p$ (momentum) basis.\n\n:::{.callout-important icon=\"true\"}\n\n## Identity operators\n\nFor position and momentum basis, the identity operators can be defined as\n$$\n\\hat{I} = \\int dx |x\\rangle\\langle x| = \\int dp |p\\rangle \\langle p|.\n$${#eq-identity-complete-basis}\n\nIn general, for any _complete orthonormal basis_ with vectors $\\{|\\phi_i\\rangle\\}$ (with $i$ integer numbers),\n\n$$\n\\hat{I} = \\sum_i |\\phi_i\\rangle \\langle \\phi_i|.\n$$\n\n:::\n\n\nIn the basis of _position eigenfunctions_ we can then define\n\n$$\n|\\psi\\rangle = \\hat{I}|\\psi\\rangle = \\int dx |x\\rangle\\langle x|\\psi\\rangle=\\int dx  \\psi(x)|x\\rangle,\n$$\n\nwhere\n$$\n\\psi(x) = \\langle x|\\psi\\rangle.\n$${#eq-psi-ket-wavefunction-def}\n\n#### Orthogonality of eigenstates\n\nThe _overlap_ between two states is given by the inner product\n\n$$\n\\langle \\psi|\\phi\\rangle=\\int dx \\psi^*(x)\\phi(x).\n$${#eq-inner-prod-dirac-wavef}\n\nStates of an orthonormal basis $\\{|\\phi_i\\rangle\\}$ satisfy the following properties:\n\n$$\n\\langle\\phi_n|\\phi_k\\rangle = \\int\\phi^*_n\\phi_kdx=\\delta_{nk},\n$$\n\nso the inner product of a wavefunction with itself is its normalization:\n\n$$\n\\langle\\psi|\\psi\\rangle=\\int|\\psi(x)|^2 dx =1\n$$\n\n\n#### Eigenstates probabilities\n\nGiven a state $|\\Psi\\rangle$ written as superposition of eigenstates (@eq-state-sum-basis), the inner product with itself is\n\n$$\n\\begin{aligned}\n\\langle \\Psi | \\Psi \\rangle &= \\langle \\sum_i c_i \\phi_i | \\sum_j c_j \\phi_j\\rangle =\\sum_{i,j} c_i^* c_j\\langle \\phi_i|\\phi_j\\rangle = \\sum_{i,j} c_i^* c_j \\delta_{i,j}\\\\\n& \\sum_i |c_i|^2 = 1.\n\\end{aligned}\n$${#eq-eigenstates-prob-dirac}\n\nThis follows from the normalization condition. The modulus square of the amplitude $c_i$ indicates the probability $P_i=|c_i|^2$ of finding the composite state in the $i$ eigenstate component.\n\n\n\n#### Expectation values\n\nRemember the sandwich!\n\n$$\n\\begin{aligned}\n\\langle \\hat{A} \\rangle &= \\int \\Psi^*(x) A\\Psi(x)dx\\\\\n&=\\langle \\Psi|\\hat{A}|\\Psi\\rangle = \\sum_i |c_i|^2 a_i = \\sum P_i a_i,\n\\end{aligned}\n$${#eq-expectation-value-dirac}\n\nwhere we used @eq-eigenstates-prob-dirac in the last passages.\n\nWhat does this result mean physically?\n\n_The expectation value is the probability-weighted average of eigenvalues._ This is in line with the correspondence principle!\n\n#### Individual measurements\n\n_What happens in repeated measuremnts of a single system?_\n\nLet's suppose that I have a _single system_ with wavefunction $\\Psi$ and do a measurement of $\\hat{A}$ on it.\n\nThe measurement collapses the wavefunction to one of the eigenstates, i.e. $\\Psi \\to \\phi_i$ with probability $P_i=|c_i|^2$, returning the quantum number $a_i$.\n\n_What happens if I repeat the measuremnt on the same system after the first one?_\n\nThe system will keep being $\\Psi=\\phi_i$ with $P_i=1$, so any consecutive measurement will return $a_i$.\n\nTo repeat the process we can apply a different operator with a different eigen-basis $\\{ \\varphi_i \\}$ repeats the process, via the decomposition $\\phi_i = \\sum_j \\langle\\phi_i|\\varphi_j\\rangle |\\varphi_j\\rangle$.\n\nThe \"projected probability amplitude\" applies between _any_ two\nwavefunctions $\\psi$ and $\\psi'$, e.g. due to sudden changes of potential\nfunction: $c = \\sqrt{P} = \\langle\\psi|\\psi'\\rangle$.\n\n\n### <span style=\"color:#336699;\">Exercise</span>\n\nFrom @eq-state-sum-basis, show that the amplitudes $c_i$ can be written as $c_i = \\langle \\phi_i | \\Psi\\rangle$.\n\n:::{.callout-tip collapse=\"true\"}\n\n## Hint\n\nUse the orthonormality of the eigenstates $\\psi_i$.\n\n:::\n\n<details>\n\n<summary>Solution</summary>\n\nStarting from  $\\Psi = \\sum_j c_j \\phi_j$, let's calculate the overlap with $\\psi_i$:\n\n$$\n\\langle \\phi_i| \\Psi\\rangle = \\sum_j c_j \\langle \\phi_i|\\phi_j\\rangle = c_i,\n$$\n\nwhere we used the orthonormality condition $\\langle \\phi_i| \\phi_j\\rangle =\\delta_{ij}$.\n\n</details>\n\n\n## Summary\n\n- Potentials deeper than the energy of a state, $E$, localize it spatially to various degrees: a bound state\n- Bound states can be described by the TISE, i.e. invariant spatial eigenfunctions with stationary-state time-evolution\n- The form of the potential determines the form of the quantization through boundary conditions: eigenstates from continuous (free particle) $\\to$ discrete for any non-trivial potential\n- General solution is (as always) a linear combination of orthogonal eigenstates... _even energy doesn’t have to be definite!_\n- For finite potentials (and delta...),wavefunction tunnels into classically forbidden regions... _but zero flux_.\n- The Dirac notation uses the matrix formalism of QM and can be useful to avoid derivatives and integrals, i.e. in the QHO calculations.\n\n",
    "supporting": [
      "p3qm-4_files/figure-html"
    ],
    "filters": [],
    "includes": {}
  }
}